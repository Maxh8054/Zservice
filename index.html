<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <title>Inspeção - Z-Services AI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800&family=Aptos:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
       :root {
    --primary-color: #000000;
    --accent-color: #FF6600;
    --text-color: #333333;
    --light-bg: #F8F9FA;
    --border-color: #E0E0E0;
    --success-color: #28a745;
    --warning-color: #ffc107;
    --danger-color: #dc3545;
    --info-color: #17a2b8;
    --sidebar-width: 250px;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Montserrat', sans-serif;
    background-color: #FFFFFF;
    color: var(--text-color);
    overflow-x: hidden;
}

/* Sidebar Styles - Melhorado */
.sidebar {
    position: fixed;
    top: 0;
    left: 0;
    height: 100vh;
    width: var(--sidebar-width);
    background-color: var(--primary-color);
    z-index: 1000;
    transition: all 0.3s ease;
    overflow-y: auto;
    box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
    transform: translateX(0);
}

.sidebar-header {
    padding: 1.5rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    background-color: rgba(0, 0, 0, 0.2);
}

.sidebar-logo {
    display: flex;
    align-items: center;
    color: white;
}

.sidebar-logo i {
    font-size: 1.8rem;
    color: var(--accent-color);
    margin-right: 12px;
}

.sidebar-logo-text {
    font-weight: 700;
    font-size: 1.3rem;
    letter-spacing: 1px;
}

.sidebar-menu {
    padding: 1rem 0;
}

.sidebar-item {
    display: flex;
    align-items: center;
    padding: 0.8rem 1.5rem;
    color: rgba(255, 255, 255, 0.8);
    text-decoration: none;
    transition: all 0.3s ease;
    position: relative;
    font-weight: 500;
}

.sidebar-item:hover {
    color: white;
    background-color: rgba(255, 255, 255, 0.05);
}

.sidebar-item.active {
    color: white;
    background-color: rgba(255, 102, 0, 0.2);
}

.sidebar-item.active::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    height: 100%;
    width: 4px;
    background-color: var(--accent-color);
}

.sidebar-item i {
    width: 24px;
    margin-right: 12px;
    text-align: center;
    font-size: 1.1rem;
}

.sidebar-toggle {
    position: fixed;
    top: 20px;
    left: 20px;
    z-index: 1002;
    background-color: var(--primary-color);
    color: white;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
}

.sidebar-toggle:hover {
    background-color: #333;
}

.sidebar-toggle.shifted {
    left: calc(var(--sidebar-width) + 20px);
}

.sidebar.collapsed {
    width: 70px;
}

.sidebar.collapsed .sidebar-logo-text {
    display: none;
}

.sidebar.collapsed .sidebar-item span {
    display: none;
}

.sidebar.collapsed .sidebar-item {
    text-align: center;
    padding: 0.8rem 0;
    justify-content: center;
}

.sidebar.collapsed .sidebar-item i {
    margin-right: 0;
    font-size: 1.3rem;
}

/* Main Content Adjustments */
.main-content {
    margin-left: var(--sidebar-width);
    transition: margin-left 0.3s ease;
    min-height: 100vh;
}

.main-content.expanded {
    margin-left: 0;
}

.slide {
    width: 100%;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    padding: 0;
    position: relative;
    background-color: #FFFFFF;
}

.slide-content {
    width: 100%;
    max-width: 1200px;
    margin: 0 auto;
    padding: 3rem 2rem;
    z-index: 2;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
}

/* Header Styles */
.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid var(--accent-color);
}

.logo-area {
    display: flex;
    align-items: center;
}

.logo-area img {
    height: 2rem;
    margin-right: 12px;
}

.logo-text {
    font-weight: 700;
    font-size: 1.5rem;
    color: var(--primary-color);
    letter-spacing: 1px;
}

.inspection-badge {
    background-color: var(--accent-color);
    color: white;
    padding: 0.4rem 1.2rem;
    border-radius: 20px;
    font-weight: 600;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    box-shadow: 0 3px 6px rgba(255, 102, 0, 0.2);
}

/* Cover Styles - Alterado para fundo branco */
.cover {
    background-color: #FFFFFF;
    color: #000000;
}

.cover-title {
    font-size: 2.2rem;
    font-weight: 800;
    margin-bottom: 0.6rem;
    color: #000000;
    line-height: 1.2;
}

/* Removido o subtítulo */

/* Card Styles */
.info-card {
    background-color: rgba(248, 249, 250, 0.9);
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    border-left: 4px solid var(--accent-color);
}

.info-card h3 {
    color: var(--primary-color);
    font-size: 1.2rem;
    margin-bottom: 1rem;
    font-weight: 600;
    display: flex;
    align-items: center;
}

.info-card h3 i {
    color: var(--accent-color);
    margin-right: 8px;
}

/* Section Separator */
.section-separator {
    margin: 1.2rem 0;
    padding: 0.3rem 0;
    border-top: 1px dashed var(--border-color);
    position: relative;
}

.section-separator span {
    position: absolute;
    top: -10px;
    left: 0;
    background-color: var(--light-bg);
    padding: 0 8px;
    color: var(--accent-color);
    font-weight: 600;
    font-size: 0.8rem;
}

/* Machine Info Item */
.machine-info-item {
    display: flex;
    margin-bottom: 0.6rem;
    align-items: center;
}

.machine-info-item:last-child {
    margin-bottom: 0;
}

.machine-info-label {
    font-weight: 600;
    color: var(--primary-color);
    min-width: 110px;
    margin-right: 0.8rem;
    font-size: 0.85rem;
}

.machine-info-value {
    flex-grow: 1;
    background-color: white;
    padding: 0.4rem 0.8rem;
    border-radius: 6px;
    border: 1px solid var(--border-color);
    font-weight: 500;
    font-size: 0.85rem;
}

.machine-info-value.yes {
    color: #28a745;
    font-weight: 600;
}

.machine-info-value.no {
    color: #dc3545;
    font-weight: 600;
}

/* Form Styles */
.form-control, .form-select {
    background-color: white;
    border: 1px solid var(--border-color);
    color: var(--text-color);
    border-radius: 6px;
    padding: 0.4rem 0.8rem;
    font-weight: 500;
    transition: all 0.3s ease;
    font-size: 0.85rem;
}

.form-control:focus, .form-select:focus {
    border-color: var(--accent-color);
    box-shadow: 0 0 0 0.2rem rgba(255, 102, 0, 0.15);
    color: var(--text-color);
}

.form-control::placeholder {
    color: #999;
    font-weight: 400;
}

.form-label {
    font-weight: 600;
    color: var(--primary-color);
    margin-bottom: 0.4rem;
    font-size: 0.85rem;
}

.form-select option {
    background-color: white;
    color: var(--text-color);
}

/* Photo Area Styles */
.photo-area {
    background-color: rgba(248, 249, 250, 0.9);
    border-radius: 12px;
    padding: 1.5rem;
    text-align: center;
    min-height: 180px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.photo-area:hover {
    background-color: rgba(240, 240, 240, 0.9);
}

.photo-area i {
    font-size: 2.5rem;
    color: var(--accent-color);
    margin-bottom: 0.8rem;
}

.photo-area p {
    color: var(--text-color);
    font-weight: 500;
    margin: 0;
    font-size: 0.85rem;
}

.photo-area img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 12px;
    position: absolute;
    top: 0;
    left: 0;
}

/* Photo Grid Styles */
.photo-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
    margin-bottom: 2rem;
}

.photo-grid-item {
    position: relative;
    height: 300px;
}

/* Photo Info Styles */
.photo-info {
    position: absolute;
    top: 12px;
    left: 12px;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 0.5rem;
    border-radius: 8px;
    z-index: 3;
    max-width: 70%;
}

.photo-info-item {
    display: flex;
    margin-bottom: 0.3rem;
    align-items: center;
}

.photo-info-item:last-child {
    margin-bottom: 0;
}

.photo-info-label {
    font-weight: 600;
    color: var(--primary-color);
    margin-right: 0.5rem;
    font-size: 0.75rem;
}

.photo-info-value {
    font-weight: 500;
    color: var(--text-color);
    font-size: 0.75rem;
}

.photo-info-value.required {
    color: var(--danger-color);
    font-weight: 600;
}

/* Photo Description Styles */
.photo-description {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    background-color: #FF6600;
    padding: 0.6rem;
    border-radius: 0 0 12px 12px;
    z-index: 2;
    max-height: 80px;
    overflow: hidden;
}

.photo-description textarea {
    background-color: #FF6600;
    border: none;
    color: #FFFFFF;
    padding: 0;
    font-size: 12px;
    resize: none;
    font-family: 'Montserrat', sans-serif;
    font-weight: 400;
    width: 100%;
    height: 40px;
    line-height: 1.3;
}

.photo-description textarea:focus {
    outline: none;
}

.photo-description textarea::placeholder {
    color: rgba(255, 255, 255, 0.6);
    font-style: italic;
}

/* Photo Actions */
.photo-actions {
    position: absolute;
    top: 12px;
    right: 12px;
    display: flex;
    gap: 8px;
    z-index: 3;
}

.photo-action-btn {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.9rem;
    color: white;
    cursor: pointer;
    transition: all 0.3s ease;
    border: none;
}

.photo-edit-btn {
    background-color: #007bff;
}

.photo-edit-btn:hover {
    background-color: #0069d9;
    transform: scale(1.1);
}

.photo-delete-btn {
    background-color: #dc3545;
}

.photo-delete-btn:hover {
    background-color: #c82333;
    transform: scale(1.1);
}

/* Back Cover Styles */
.back-cover {
    background-color: white;
}

.back-cover .header {
    border-bottom: 2px solid var(--accent-color);
}

.section-title {
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 2rem;
    color: var(--primary-color);
    position: relative;
    display: inline-block;
}

.section-title::after {
    content: '';
    position: absolute;
    bottom: -8px;
    left: 0;
    width: 60px;
    height: 3px;
    background-color: var(--accent-color);
    border-radius: 2px;
}

/* Footer Styles */
.footer {
    background-color: var(--primary-color);
    color: white;
    padding: 1rem 0;
    text-align: center;
    font-size: 0.8rem;
    font-weight: 500;
    margin-top: auto;
}

/* Button Styles */
.btn-primary {
    background-color: var(--accent-color);
    border-color: var(--accent-color);
    color: white;
    padding: 0.6rem 1.2rem;
    font-weight: 600;
    border-radius: 6px;
    transition: all 0.3s ease;
    box-shadow: 0 3px 6px rgba(255, 102, 0, 0.2);
}

.btn-primary:hover {
    background-color: #E55A00;
    border-color: #E55A00;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(255, 102, 0, 0.3);
}

.btn-secondary {
    background-color: #6c757d;
    border-color: #6c757d;
    color: white;
    padding: 0.6rem 1.2rem;
    font-weight: 600;
    border-radius: 6px;
    transition: all 0.3s ease;
    margin-right: 8px;
}

.btn-secondary:hover {
    background-color: #5a6268;
    border-color: #545b62;
    transform: translateY(-2px);
}

.btn-add-photos {
    background-color: #28a745;
    border-color: #28a745;
    color: white;
    padding: 0.6rem 1.2rem;
    font-weight: 600;
    border-radius: 6px;
    transition: all 0.3s ease;
    margin-bottom: 1rem;
}

.btn-add-photos:hover {
    background-color: #218838;
    border-color: #1e7e34;
    transform: translateY(-2px);
}

.btn-clear-report {
    background-color: #dc3545;
    border-color: #dc3545;
    color: white;
    padding: 0.6rem 1.2rem;
    font-weight: 600;
    border-radius: 6px;
    transition: all 0.3s ease;
    margin-bottom: 1rem;
}

.btn-clear-report:hover {
    background-color: #c82333;
    border-color: #bd2130;
    transform: translateY(-2px);
}

.btn-download {
    background-color: #007bff;
    border-color: #007bff;
    color: white;
    padding: 0.6rem 1.2rem;
    font-weight: 600;
    border-radius: 6px;
    transition: all 0.3s ease;
    margin-bottom: 1rem;
}

.btn-download:hover {
    background-color: #0069d9;
    border-color: #0062cc;
    transform: translateY(-2px);
}

/* Photo Counter Section */
.photo-counter-section {
    background-color: var(--light-bg);
    border-radius: 12px;
    padding: 1rem;
    margin-bottom: 1rem;
    display: none;
    border-left: 4px solid var(--accent-color);
}

.photo-counter-section.show {
    display: block;
}

.photo-counter-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.photo-counter-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--primary-color);
    display: flex;
    align-items: center;
}

.photo-counter-title i {
    color: var(--accent-color);
    margin-right: 8px;
}

.photo-counter-close {
    background: none;
    border: none;
    font-size: 1.2rem;
    color: var(--text-color);
    cursor: pointer;
    padding: 0.2rem;
    border-radius: 50%;
    transition: all 0.3s ease;
}

.photo-counter-close:hover {
    background-color: var(--border-color);
}

.photo-counter-input-group {
    display: flex;
    align-items: center;
    gap: 1rem;
}

.photo-counter-input {
    flex: 1;
    max-width: 200px;
}

.photo-counter-info {
    font-size: 0.85rem;
    color: #666;
    font-style: italic;
}

.photo-counter-actions {
    display: flex;
    gap: 0.5rem;
    margin-top: 1rem;
}

/* Backup Status */
.backup-status {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-size: 0.8rem;
    z-index: 1000;
    display: flex;
    align-items: center;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.backup-status.show {
    opacity: 1;
}

.backup-status i {
    margin-right: 0.5rem;
}

/* Numero da Peça Table Section */
.pn-table-section {
    background-color: var(--light-bg);
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    border-left: 4px solid var(--accent-color);
    position: relative;
}

.pn-table-section h3 {
    color: var(--primary-color);
    font-size: 1.5rem;
    margin-bottom: 1rem;
    font-weight: 700;
    display: flex;
    align-items: center;
}

.pn-table-section h3 i {
    color: var(--accent-color);
    margin-right: 8px;
}

.pn-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 1rem;
}

.pn-table th, .pn-table td {
    padding: 0.8rem;
    text-align: left;
    border-bottom: 1px solid var(--border-color);
}

.pn-table th {
    background-color: var(--primary-color);
    color: white;
    font-weight: 600;
}

.pn-table tr:hover {
    background-color: rgba(255, 102, 0, 0.1);
}

/* Conclusão Section */
.conclusion-section {
    background-color: var(--light-bg);
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    border-left: 4px solid var(--accent-color);
    position: relative;
}

.conclusion-section h3 {
    color: var(--primary-color);
    font-size: 1.5rem;
    margin-bottom: 1rem;
    font-weight: 700;
    display: flex;
    align-items: center;
}

.conclusion-section h3 i {
    color: var(--accent-color);
    margin-right: 8px;
}

/* Action Buttons - Melhorados com cores por funcionalidade */
.action-buttons {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 1000;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.action-btn {
    width: 45px;
    height: 45px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.1rem;
    box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
    transition: all 0.3s ease;
    border: none;
    color: white;
    cursor: pointer;
    position: relative;
}

.action-btn:hover {
    transform: scale(1.1);
}

/* Tooltip para os botões de ação */
.action-btn::after {
    content: attr(title);
    position: absolute;
    right: 55px;
    top: 50%;
    transform: translateY(-50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 5px 10px;
    border-radius: 4px;
    font-size: 12px;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
}

.action-btn:hover::after {
    opacity: 1;
}

/* Loading Spinner */
.loading-spinner {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 9999;
    background: rgba(255, 255, 255, 0.95);
    padding: 1.5rem;
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
    text-align: center;
    min-width: 280px;
}

.loading-spinner.active {
    display: block;
}

.loading-text {
    margin-top: 0.8rem;
    font-weight: 600;
    color: var(--accent-color);
    font-size: 0.9rem;
}

.error-text {
    margin-top: 0.8rem;
    font-weight: 600;
    color: #dc3545;
    font-size: 0.8rem;
}

.success-text {
    margin-top: 0.8rem;
    font-weight: 600;
    color: #28a745;
    font-size: 0.8rem;
}

/* Progress Bar */
.progress {
    height: 20px;
    background-color: #e9ecef;
    border-radius: 10px;
    margin-top: 10px;
    overflow: hidden;
}

.progress-bar {
    background-color: var(--accent-color);
    color: white;
    text-align: center;
    font-weight: 600;
    font-size: 12px;
    line-height: 20px;
    transition: width 0.3s ease;
}

/* Modal Styles */
.modal {
    display: none;
    position: fixed;
    z-index: 9999;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.8);
}

.modal.show {
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-content {
    background-color: #fefefe;
    margin: auto;
    padding: 0;
    border-radius: 12px;
    width: 90%;
    max-width: 900px;
    max-height: 90vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.modal-header {
    padding: 1rem 1.5rem;
    background-color: var(--primary-color);
    color: white;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-title {
    font-size: 1.2rem;
    font-weight: 600;
    margin: 0;
}

.modal-close {
    background: none;
    border: none;
    color: white;
    font-size: 1.5rem;
    cursor: pointer;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background-color 0.3s;
}

.modal-close:hover {
    background-color: rgba(255, 255, 255, 0.2);
}

.modal-body {
    padding: 1.5rem;
    overflow-y: auto;
    flex-grow: 1;
}

.modal-footer {
    padding: 1rem 1.5rem;
    background-color: #f8f9fa;
    border-top: 1px solid #dee2e6;
    display: flex;
    justify-content: flex-end;
    gap: 0.5rem;
}

/* Editor Toolbar */
.editor-toolbar {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    margin-bottom: 1rem;
    padding: 0.75rem;
    background-color: #f8f9fa;
    border-radius: 8px;
}

.editor-tool-btn {
    padding: 0.5rem;
    border: 1px solid #dee2e6;
    background-color: white;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
}

.editor-tool-btn:hover {
    background-color: #e9ecef;
    transform: translateY(-2px);
}

.editor-tool-btn.active {
    background-color: var(--accent-color);
    color: white;
    border-color: var(--accent-color);
}

.editor-color-picker {
    width: 40px;
    height: 40px;
    border: 1px solid #dee2e6;
    border-radius: 6px;
    cursor: pointer;
}

.editor-canvas-container {
    position: relative;
    width: 100%;
    height: 400px;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    overflow: hidden;
    background-color: #f8f9fa;
}

/* Confirmation Dialog */
.confirmation-dialog {
    display: none;
    position: fixed;
    z-index: 10000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.5);
}

.confirmation-dialog.show {
    display: flex;
    align-items: center;
    justify-content: center;
}

.confirmation-content {
    background-color: white;
    padding: 2rem;
    border-radius: 12px;
    width: 90%;
    max-width: 400px;
    text-align: center;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
}

.confirmation-icon {
    font-size: 3rem;
    color: #dc3545;
    margin-bottom: 1rem;
}

.confirmation-title {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 1rem;
    color: var(--primary-color);
}

.confirmation-message {
    font-size: 1rem;
    margin-bottom: 2rem;
    color: var(--text-color);
}

.confirmation-actions {
    display: flex;
    justify-content: center;
    gap: 1rem;
}

/* Photo Options Menu */
.photo-options-menu {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
    padding: 1.5rem;
    z-index: 10000;
    min-width: 300px;
    display: none;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.photo-options-menu.show {
    display: block;
    opacity: 1;
}

.photo-options-title {
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 1rem;
    color: var(--primary-color);
    text-align: center;
}

.photo-option-btn {
    display: flex;
    align-items: center;
    width: 100%;
    padding: 0.8rem;
    margin-bottom: 0.5rem;
    background-color: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
    font-size: 0.95rem;
    font-weight: 500;
}

.photo-option-btn:hover {
    background-color: #e9ecef;
    transform: translateY(-2px);
}

.photo-option-btn i {
    margin-right: 0.8rem;
    color: var(--accent-color);
}

.photo-option-cancel {
    background-color: #6c757d;
    color: white;
    border-color: #6c757d;
}

.photo-option-cancel:hover {
    background-color: #5a6268;
}

.photo-option-cancel i {
    color: white;
}

/* Config Section */
.config-section {
    display: none;
    position: fixed;
    top: 80px;
    right: 20px;
    background: white;
    padding: 1.5rem;
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    z-index: 1000;
    min-width: 350px;
    max-height: 80vh;
    overflow-y: auto;
}

.config-section.show {
    display: block;
}

.config-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid var(--accent-color);
}

.config-title {
    font-size: 1.2rem;
    font-weight: 600;
    color: var(--primary-color);
    display: flex;
    align-items: center;
}

.config-title i {
    color: var(--accent-color);
    margin-right: 8px;
}

.config-close {
    background: none;
    border: none;
    font-size: 1.2rem;
    color: var(--text-color);
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 50%;
    transition: all 0.3s;
}

.config-close:hover {
    background-color: var(--light-bg);
}

/* Fullscreen Modal */
.fullscreen-modal {
    display: none;
    position: fixed;
    z-index: 20000;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.95);
    overflow: hidden;
}

.fullscreen-modal.show {
    display: flex;
    align-items: center;
    justify-content: center;
}

.fullscreen-container {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.fullscreen-image {
    max-width: 95%;
    max-height: 95%;
    object-fit: contain;
    transition: transform 0.3s ease;
    cursor: zoom-in;
}

.fullscreen-image.zoomed {
    cursor: zoom-out;
    transform: scale(2);
}

.fullscreen-controls {
    position: absolute;
    top: 20px;
    right: 20px;
    display: flex;
    gap: 10px;
    z-index: 20001;
}

.fullscreen-btn {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.2);
    border: 2px solid white;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 1.2rem;
}

.fullscreen-btn:hover {
    background-color: rgba(255, 255, 255, 0.3);
    transform: scale(1.1);
}

.fullscreen-nav {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.2);
    border: 2px solid white;
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    font-size: 1.5rem;
    z-index: 20001;
}

.fullscreen-nav:hover {
    background-color: rgba(255, 255, 255, 0.3);
    transform: translateY(-50%) scale(1.1);
}

.fullscreen-nav.prev {
    left: 20px;
}

.fullscreen-nav.next {
    right: 20px;
}

.fullscreen-info {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 10px 20px;
    border-radius: 20px;
    font-size: 0.9rem;
    z-index: 20001;
}

/* Translation Tool Styles */
.translation-tool {
    position: fixed;
    bottom: 20px;
    left: 20px;
    background-color: white;
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    padding: 1rem;
    z-index: 1000;
    min-width: 300px;
    max-width: 400px;
    display: none;
}

.translation-tool.show {
    display: block;
}

.translation-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid #dee2e6;
}

.translation-title {
    font-size: 1rem;
    font-weight: 600;
    color: var(--primary-color);
    display: flex;
    align-items: center;
}

.translation-title i {
    color: var(--accent-color);
    margin-right: 8px;
}

.translation-close {
    background: none;
    border: none;
    font-size: 1.2rem;
    color: var(--text-color);
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 50%;
    transition: all 0.3s;
}

.translation-close:hover {
    background-color: var(--light-bg);
}

.translation-controls {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
}

.translation-select {
    flex: 1;
    padding: 0.5rem;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    font-size: 0.9rem;
}

.translation-swap {
    background-color: var(--accent-color);
    color: white;
    border: none;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s;
}

.translation-swap:hover {
    background-color: #E55A00;
    transform: rotate(180deg);
}

.translation-actions {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
}

.translation-btn {
    flex: 1;
    padding: 0.5rem;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    background-color: white;
    color: var(--text-color);
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.3s;
}

.translation-btn:hover {
    background-color: var(--light-bg);
}

.translation-btn.translate {
    background-color: var(--accent-color);
    color: white;
    border-color: var(--accent-color);
}

.translation-btn.translate:hover {
    background-color: #E55A00;
}

.translation-status {
    font-size: 0.8rem;
    color: #666;
    margin-top: 0.5rem;
    text-align: center;
}

.text-detection-mode {
    position: fixed;
    top: 80px;
    left: 20px;
    background-color: white;
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    padding: 1rem;
    z-index: 1000;
    min-width: 250px;
    display: none;
}

.text-detection-mode.show {
    display: block;
}

.detection-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    padding-bottom: 0.5rem;
    border-bottom: 1px solid #dee2e6;
}

.detection-title {
    font-size: 1rem;
    font-weight: 600;
    color: var(--primary-color);
    display: flex;
    align-items: center;
}

.detection-title i {
    color: var(--accent-color);
    margin-right: 8px;
}

.detection-close {
    background: none;
    border: none;
    font-size: 1.2rem;
    color: var(--text-color);
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 50%;
    transition: all 0.3s;
}

.detection-close:hover {
    background-color: var(--light-bg);
}

.detection-options {
    margin-bottom: 1rem;
}

.detection-option {
    display: flex;
    align-items: center;
    margin-bottom: 0.5rem;
}

.detection-option input {
    margin-right: 0.5rem;
}

.detection-option label {
    font-size: 0.9rem;
    cursor: pointer;
}

.detection-actions {
    display: flex;
    gap: 0.5rem;
}

.detection-btn {
    flex: 1;
    padding: 0.5rem;
    border: 1px solid var(--border-color);
    border-radius: 6px;
    background-color: white;
    color: var(--text-color);
    font-size: 0.9rem;
    cursor: pointer;
    transition: all 0.3s;
}

.detection-btn:hover {
    background-color: var(--light-bg);
}

.detection-btn.start {
    background-color: var(--success-color);
    color: white;
    border-color: var(--success-color);
}

.detection-btn.start:hover {
    background-color: #218838;
}

.detection-btn.stop {
    background-color: var(--danger-color);
    color: white;
    border-color: var(--danger-color);
}

.detection-btn.stop:hover {
    background-color: #c82333;
}

.highlighted-element {
    position: relative;
    outline: 2px dashed var(--accent-color);
    outline-offset: 2px;
    transition: all 0.3s ease;
}

.highlighted-element:hover {
    background-color: rgba(255, 102, 0, 0.05);
}

.text-badge {
    position: absolute;
    top: -8px;
    right: -8px;
    background-color: var(--accent-color);
    color: white;
    border-radius: 50%;
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    font-weight: bold;
    z-index: 1001;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}

/* Final Slide Styles */
.final-slide {
    background-color: #FFFFFF;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 2rem 0;
}

.final-slide .separator-line {
    width: 100px;
    height: 4px;
    background-color: var(--accent-color);
    margin: 1.5rem auto;
}

.final-slide .safety-quote {
    margin: 2rem 0;
}

.final-slide .quote-text {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--accent-color);
    margin-bottom: 1rem;
    font-family: 'Aptos', sans-serif;
}

.final-slide .quote-subtext {
    font-size: 2rem;
    font-weight: 600;
    color: var(--accent-color);
    font-family: 'Aptos', sans-serif;
}

.final-slide .center-logo {
    margin: 3rem 0;
    width: 300px;
    height: 170px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.final-slide .center-logo img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

.final-slide .end-text {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--accent-color);
    margin-top: 2rem;
    font-family: 'Aptos', sans-serif;
}

/* Email Options Menu */
.email-options-menu {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    border-radius: 12px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
    padding: 1.5rem;
    z-index: 10000;
    min-width: 250px;
    display: none;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.email-options-menu.show {
    display: block;
    opacity: 1;
}

.email-options-title {
    font-size: 1.2rem;
    font-weight: 600;
    margin-bottom: 1rem;
    color: var(--primary-color);
    text-align: center;
}

.email-option-btn {
    display: flex;
    align-items: center;
    width: 100%;
    padding: 0.8rem;
    margin-bottom: 0.5rem;
    background-color: #f8f9fa;
    border: 1px solid #dee2e6;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
    font-size: 0.95rem;
    font-weight: 500;
}

.email-option-btn:hover {
    background-color: #e9ecef;
    transform: translateY(-2px);
}

.email-option-btn i {
    margin-right: 0.8rem;
    color: var(--accent-color);
}

.email-option-cancel {
    background-color: #6c757d;
    color: white;
    border-color: #6c757d;
}

.email-option-cancel:hover {
    background-color: #5a6268;
}

.email-option-cancel i {
    color: white;
}

/* Responsive Styles */
@media (max-width: 768px) {
    .cover-title {
        font-size: 1.8rem;
    }
    
    .photo-grid {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    
    .header {
        flex-direction: column;
        gap: 0.8rem;
        text-align: center;
    }
    
    .machine-info-item {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .machine-info-label {
        min-width: auto;
        margin-bottom: 0.4rem;
    }
    
    .action-buttons {
        top: 10px;
        right: 10px;
    }
    
    .slide-content {
        padding: 2rem 1rem;
    }
    
    .photo-grid-item {
        height: 250px;
    }
    
    .photo-counter-input-group {
        flex-direction: column;
        align-items: stretch;
    }
    
    .photo-counter-input {
        max-width: none;
    }
    
    .modal-content {
        width: 95%;
        max-height: 95vh;
    }
    
    .editor-toolbar {
        justify-content: center;
    }
    
    .photo-options-menu {
        width: 90%;
        min-width: auto;
    }
    
    .config-section {
        right: 10px;
        left: 10px;
        min-width: auto;
    }
    
    .fullscreen-controls {
        top: 10px;
        right: 10px;
    }
    
    .fullscreen-btn {
        width: 40px;
        height: 40px;
        font-size: 1rem;
    }
    
    .fullscreen-nav {
        width: 50px;
        height: 50px;
        font-size: 1.2rem;
    }
    
    .fullscreen-nav.prev {
        left: 10px;
    }
    
    .fullscreen-nav.next {
        right: 10px;
    }
    
    .translation-tool {
        bottom: 10px;
        left: 10px;
        right: 10px;
        min-width: auto;
        max-width: none;
    }
    
    .text-detection-mode {
        top: 70px;
        left: 10px;
        right: 10px;
        min-width: auto;
    }
    
    .final-slide .quote-text {
        font-size: 2rem;
    }
    
    .final-slide .quote-subtext {
        font-size: 1.5rem;
    }
    
    .final-slide .center-logo {
        width: 200px;
        height: 113px;
    }
    
    .final-slide .end-text {
        font-size: 2rem;
    }
}

@media print {
    .slide {
        page-break-after: always;
    }
    
    .action-buttons {
        display: none;
    }
    
    .backup-status {
        display: none;
    }
    
    .photo-counter-section {
        display: none;
    }
    
    .config-section {
        display: none;
    }
    
    .translation-tool {
        display: none;
    }
    
    .text-detection-mode {
        display: none;
    }
}

/* Estilos Mobile Adicionais */
@media (max-width: 768px) {
    /* Sidebar em mobile - sempre colapsada */
    .sidebar {
        transform: translateX(-100%);
        width: 70px;
    }
    
    .sidebar.collapsed {
        transform: translateX(0);
    }
    
    .sidebar .sidebar-logo-text,
    .sidebar .sidebar-item span {
        display: none;
    }
    
    .sidebar .sidebar-item {
        padding: 0.8rem 0;
        justify-content: center;
    }
    
    .sidebar .sidebar-item i {
        margin-right: 0;
        font-size: 1.3rem;
    }
    
    .sidebar-toggle {
        left: 20px;
        z-index: 1002;
    }
    
    .sidebar-toggle.shifted {
        left: 20px;
    }
    
    /* Main content em mobile */
    .main-content {
        margin-left: 0;
        padding-top: 60px;
    }
    
    .main-content.expanded {
        margin-left: 0;
    }
    
    /* Ajustes de slides em mobile */
    .slide {
        min-height: 100vh;
        padding: 1rem 0;
    }
    
    .slide-content {
        padding: 1rem;
    }
    
    /* Header em mobile */
    .header {
        flex-direction: column;
        gap: 0.5rem;
        padding-bottom: 0.5rem;
        text-align: center;
    }
    
    .logo-area {
        justify-content: center;
    }
    
    .logo-text {
        font-size: 1.2rem;
    }
    
    .inspection-badge {
        font-size: 0.8rem;
        padding: 0.3rem 0.8rem;
    }
    
    /* Cover em mobile */
    .cover-title {
        font-size: 1.5rem;
        margin-bottom: 0.5rem;
    }
    
    /* Info cards em mobile */
    .info-card {
        padding: 1rem;
        margin-bottom: 1rem;
    }
    
    .info-card h3 {
        font-size: 1rem;
        margin-bottom: 0.8rem;
    }
    
    .machine-info-item {
        flex-direction: column;
        align-items: flex-start;
        margin-bottom: 0.8rem;
    }
    
    .machine-info-label {
        margin-bottom: 0.3rem;
        font-size: 0.8rem;
    }
    
    .machine-info-value {
        font-size: 0.8rem;
        padding: 0.3rem 0.6rem;
        width: 100%;
    }
    
    /* Form controls em mobile */
    .form-control, .form-select {
        font-size: 0.8rem;
        padding: 0.3rem 0.6rem;
    }
    
    .form-label {
        font-size: 0.8rem;
        margin-bottom: 0.3rem;
    }
    
    /* Photo grid em mobile */
    .photo-grid {
        grid-template-columns: 1fr;
        gap: 0.8rem;
    }
    
    .photo-grid-item {
        height: 250px;
    }
    
    .photo-info {
        padding: 0.5rem;
    }
    
    .photo-info-label {
        font-size: 0.7rem;
    }
    
    .photo-info-value {
        font-size: 0.7rem;
        padding: 0.2rem 0.4rem;
    }
    
    .photo-description {
        max-height: 60px;
    }
    
    .photo-description textarea {
        font-size: 0.7rem;
        height: 30px;
    }
    
    /* Photo actions em mobile */
    .photo-actions {
        top: 8px;
        right: 8px;
    }
    
    .photo-action-btn {
        width: 28px;
        height: 28px;
        font-size: 0.8rem;
    }
    
    /* Tabela PN em mobile */
    .pn-table-section {
        padding: 1rem;
        overflow-x: auto;
    }
    
    .pn-table-section h3 {
        font-size: 1.2rem;
    }
    
    .pn-table {
        font-size: 0.7rem;
        min-width: 500px;
    }
    
    .pn-table th, .pn-table td {
        padding: 0.5rem;
    }
    
    /* Conclusão em mobile */
    .conclusion-section {
        padding: 1rem;
    }
    
    .conclusion-section h3 {
        font-size: 1.2rem;
    }
    
    /* Botões de ação em mobile */
    .action-buttons {
        top: 10px;
        right: 10px;
        gap: 5px;
    }
    
    .action-btn {
        width: 40px;
        height: 40px;
        font-size: 1rem;
    }
    
    /* Modais em mobile */
    .modal-content {
        width: 95%;
        max-height: 95vh;
    }
    
    .modal-header {
        padding: 0.8rem 1rem;
    }
    
    .modal-body {
        padding: 1rem;
    }
    
    .modal-footer {
        padding: 0.8rem 1rem;
    }
    
    /* Editor de foto em mobile */
    .editor-toolbar {
        justify-content: center;
        gap: 0.3rem;
        padding: 0.5rem;
    }
    
    .editor-tool-btn {
        width: 35px;
        height: 35px;
        font-size: 0.9rem;
    }
    
    .editor-color-picker {
        width: 35px;
        height: 35px;
    }
    
    .editor-canvas-container {
        height: 300px;
    }
    
    /* Fullscreen em mobile */
    .fullscreen-controls {
        top: 10px;
        right: 10px;
    }
    
    .fullscreen-btn {
        width: 40px;
        height: 40px;
        font-size: 1rem;
    }
    
    .fullscreen-nav {
        width: 45px;
        height: 45px;
        font-size: 1.2rem;
    }
    
    .fullscreen-nav.prev {
        left: 10px;
    }
    
    .fullscreen-nav.next {
        right: 10px;
    }
    
    .fullscreen-info {
        font-size: 0.8rem;
        bottom: 10px;
    }
    
    /* Translation tool em mobile */
    .translation-tool {
        bottom: 10px;
        left: 10px;
        right: 10px;
        min-width: auto;
        max-width: none;
    }
    
    .translation-controls {
        flex-direction: column;
        gap: 0.5rem;
    }
    
    .translation-select {
        width: 100%;
    }
    
    .translation-swap {
        align-self: center;
    }
    
    /* Text detection mode em mobile */
    .text-detection-mode {
        top: 70px;
        left: 10px;
        right: 10px;
        min-width: auto;
    }
    
    /* Config section em mobile */
    .config-section {
        right: 10px;
        left: 10px;
        min-width: auto;
    }
    
    /* Loading spinner em mobile */
    .loading-spinner {
        width: 90%;
        min-width: auto;
        padding: 1rem;
    }
    
    /* Final slide em mobile */
    .final-slide .quote-text {
        font-size: 1.8rem;
    }
    
    .final-slide .quote-subtext {
        font-size: 1.4rem;
    }
    
    .final-slide .center-logo {
        width: 200px;
        height: 113px;
    }
    
    .final-slide .end-text {
        font-size: 1.8rem;
    }
}

/* Ajustes para telas muito pequenas */
@media (max-width: 480px) {
    .slide-content {
        padding: 0.5rem;
    }
    
    .cover-title {
        font-size: 1.3rem;
    }
    
    .info-card {
        padding: 0.8rem;
    }
    
    .photo-grid-item {
        height: 200px;
    }
    
    .action-buttons {
        top: 5px;
        right: 5px;
        gap: 3px;
    }
    
    .action-btn {
        width: 35px;
        height: 35px;
        font-size: 0.9rem;
    }
}
    </style>
</head>
<body>
    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">
                <i class="fas fa-cogs"></i>
            </div>
        </div>
        <div class="sidebar-menu">
            <a href="Inspeçãotool.html" class="sidebar-item">
                <i class="fas fa-clipboard-list"></i>
                <span>Inspeção</span>
            </a>
            <a href="Relatoriotool.html" class="sidebar-item active">
                <i class="fas fa-tools"></i>
                <span>Relatório</span>
            </a>
        </div>
    </nav>

    <!-- Sidebar Toggle Button -->
    <button class="sidebar-toggle shifted" id="sidebarToggle">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- Action Buttons - Melhorados com cores por funcionalidade -->
    <div class="action-buttons">
        <!-- Configurações - Cinza (configuração) -->
        <button class="action-btn" style="background-color: #6c757d;" onclick="toggleConfig()" title="Configurar">
            <i class="fas fa-cog"></i>
        </button>
        
        <!-- Adicionar Múltiplas Fotos - Verde (adicionar) -->
        <button class="action-btn" style="background-color: #28a745;" onclick="addMultiplePhotos()" title="Adicionar Múltiplas Fotos">
            <i class="fas fa-images"></i>
        </button>
        
        <!-- Limpar Relatório - Vermelho (excluir/limpar) -->
        <button class="action-btn" style="background-color: #dc3545;" onclick="showClearConfirmation()" title="Limpar Relatório">
            <i class="fas fa-trash-alt"></i>
        </button>
        
        <!-- Exportar Dados - Azul (exportar/salvar) -->
        <button class="action-btn" style="background-color: #007bff;" onclick="exportData()" title="Exportar Dados">
            <i class="fas fa-file-export"></i>
        </button>
        
        <!-- Importar Dados - Azul escuro (importar/carregar) -->
        <button class="action-btn" style="background-color: #0056b3;" onclick="importData()" title="Importar Dados">
            <i class="fas fa-file-import"></i>
        </button>
        
        <!-- Baixar Relatório - Roxo (baixar/download) -->
        <button class="action-btn" style="background-color: #6f42c1;" onclick="generatePowerPoint()" title="Baixar Relatório">
            <i class="fas fa-download"></i>
        </button>
        
          <!-- Traduzir - Laranja (tradução) -->
    <button class="action-btn" style="background-color: #fd7e14;" id="translateBtn" title="Traduzir">
        <i class="fas fa-language"></i>
    </button>
    
    <!-- Email - Azul claro (comunicação) -->
    <button class="action-btn" style="background-color: #17a2b8;" onclick="toggleEmailMenu()" title="Enviar E-mail">
        <i class="fas fa-envelope"></i>
    </button>
</div>

    <!-- Translation Tool -->
    <div class="translation-tool" id="translationTool">
        <div class="translation-header">
            <h5 class="translation-title">
                <i class="fas fa-language me-2"></i>Ferramenta de Tradução
            </h5>
            <button class="translation-close" id="closeTranslationBtn">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="translation-controls">
            <select class="translation-select" id="sourceLanguage">
                <option value="pt">Português</option>
                <option value="en">Inglês</option>
                <option value="ja">Japonês</option>
            </select>
            <button class="translation-swap" id="swapLanguagesBtn" title="Trocar idiomas">
                <i class="fas fa-exchange-alt"></i>
            </button>
            <select class="translation-select" id="targetLanguage">
                <option value="en">Inglês</option>
                <option value="pt">Português</option>
                <option value="ja">Japonês</option>
            </select>
        </div>
        
        <div class="translation-actions">
            <button class="translation-btn" id="detectTextBtn">
                <i class="fas fa-search me-1"></i>Detectar Textos
            </button>
            <button class="translation-btn translate" id="translateAllBtn">
                <i class="fas fa-globe me-1"></i>Traduzir Tudo
            </button>
        </div>
        
        <div class="translation-status" id="translationStatus">
            Clique em "Detectar Textos" para identificar todos os textos na página
        </div>
    </div>

    <!-- Text Detection Mode -->
    <div class="text-detection-mode" id="textDetectionMode">
        <div class="detection-header">
            <h5 class="detection-title">
                <i class="fas fa-search me-2"></i>Modo de Detecção
            </h5>
            <button class="detection-close" id="closeDetectionBtn">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="detection-options">
            <div class="detection-option">
                <input type="checkbox" id="detectLabels" checked>
                <label for="detectLabels">Rótulos e Títulos</label>
            </div>
            <div class="detection-option">
                <input type="checkbox" id="detectPlaceholders" checked>
                <label for="detectPlaceholders">Placeholders</label>
            </div>
            <div class="detection-option">
                <input type="checkbox" id="detectButtons" checked>
                <label for="detectButtons">Botões</label>
            </div>
            <div class="detection-option">
                <input type="checkbox" id="detectInputs" checked>
                <label for="detectInputs">Campos de Entrada</label>
            </div>
            <div class="detection-option">
                <input type="checkbox" id="detectDescriptions" checked>
                <label for="detectDescriptions">Descrições</label>
            </div>
        </div>
        
        <div class="detection-actions">
            <button class="detection-btn start" id="startDetectionBtn">
                <i class="fas fa-play me-1"></i>Iniciar
            </button>
            <button class="detection-btn stop" id="stopDetectionBtn">
                <i class="fas fa-stop me-1"></i>Parar
            </button>
        </div>
    </div>

    <!-- Backup Status -->
    <div class="backup-status" id="backupStatus">
        <i class="fas fa-check-circle"></i>
        <span>Dados salvos automaticamente</span>
    </div>

    <!-- Loading Spinner -->
    <div class="loading-spinner" id="loadingSpinner">
        <div class="spinner-border text-primary" role="status" style="width: 2.5rem; height: 2.5rem;">
            <span class="visually-hidden">Carregando...</span>
        </div>
        <div class="loading-text">Gerando PowerPoint...</div>
        <div class="error-text" id="errorText" style="display: none;"></div>
        <div class="success-text" id="successText" style="display: none;"></div>
    </div>

    <!-- Photo Editor Modal -->
    <div id="photoEditorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Editor de Foto</h5>
                <button class="modal-close" onclick="closePhotoEditor()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="editor-toolbar">
                    <button class="editor-tool-btn" onclick="setDrawingMode('select')" title="Selecionar">
                        <i class="fas fa-mouse-pointer"></i>
                    </button>
                    <button class="editor-tool-btn" onclick="setDrawingMode('pen')" title="Caneta">
                        <i class="fas fa-pen"></i>
                    </button>
                    <button class="editor-tool-btn" onclick="setDrawingMode('circle')" title="Círculo">
                        <i class="far fa-circle"></i>
                    </button>
                    <button class="editor-tool-btn" onclick="setDrawingMode('rectangle')" title="Retângulo">
                        <i class="far fa-square"></i>
                    </button>
                    <button class="editor-tool-btn" onclick="setDrawingMode('arrow')" title="Seta">
                        <i class="fas fa-long-arrow-alt-right"></i>
                    </button>
                    <button class="editor-tool-btn" onclick="setDrawingMode('text')" title="Texto">
                        <i class="fas fa-font"></i>
                    </button>
                    <input type="color" class="editor-color-picker" id="colorPicker" value="#FF6600" title="Cor">
                    <button class="editor-tool-btn" onclick="deleteSelected()" title="Excluir Selecionado">
                        <i class="fas fa-trash"></i>
                    </button>
                    <button class="editor-tool-btn" onclick="clearCanvas()" title="Limpar Edições">
                        <i class="fas fa-eraser"></i>
                    </button>
                </div>
                <div class="editor-canvas-container">
                    <canvas id="photoEditorCanvas"></canvas>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closePhotoEditor()">Cancelar</button>
                <button type="button" class="btn btn-primary" onclick="savePhotoEdit()">Salvar</button>
            </div>
        </div>
    </div>

    <!-- Fullscreen Modal -->
    <div id="fullscreenModal" class="fullscreen-modal">
        <div class="fullscreen-container">
            <img id="fullscreenImage" class="fullscreen-image" src="" alt="Fullscreen Image">
            
            <div class="fullscreen-controls">
                <button class="fullscreen-btn" onclick="toggleZoom()" title="Zoom">
                    <i class="fas fa-search-plus"></i>
                </button>
                <button class="fullscreen-btn" onclick="closeFullscreen()" title="Fechar">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <button class="fullscreen-nav prev" onclick="navigateFullscreen(-1)" title="Anterior">
                <i class="fas fa-chevron-left"></i>
            </button>
            
            <button class="fullscreen-nav next" onclick="navigateFullscreen(1)" title="Próxima">
                <i class="fas fa-chevron-right"></i>
            </button>
            
            <div class="fullscreen-info" id="fullscreenInfo">
                Foto 1 de 1
            </div>
        </div>
    </div>

    <!-- Confirmation Dialog -->
    <div id="confirmationDialog" class="confirmation-dialog">
        <div class="confirmation-content">
            <div class="confirmation-icon">
                <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h3 class="confirmation-title">Tem certeza?</h3>
            <p class="confirmation-message">Esta ação irá limpar TODOS os dados do relatório, incluindo textos, fotos anexadas, títulos, descrições e edições. Esta ação não pode ser desfeita.</p>
            <div class="confirmation-actions">
                <button type="button" class="btn btn-secondary" onclick="closeConfirmationDialog()">Cancelar</button>
                <button type="button" class="btn btn-danger" onclick="clearReport()">Limpar Tudo</button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Slide 1: Capa -->
        <div class="slide cover" id="slide1">
            <div class="slide-content">
                <div class="header">
                    <div class="logo-area">
                        <img src="data:image/png;base64,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" alt="Logo">
                    </div>
                    <div class="inspection-badge">
                        <i class="fas fa-clipboard-check me-2"></i>INSPEÇÃO
                    </div>
                </div>
                
                <h1 class="cover-title">Relatório Técnico</h1>
                
                <div class="info-card">
                    <h3><i class="fas fa-clipboard-list"></i>Informações da Inspeção</h3>
                   <!-- Machine Information Section -->
<div class="machine-info-item">
    <div class="machine-info-label">TAG:</div>
    <div style="position: relative; flex-grow: 1;">
        <input
            class="machine-info-value form-control"
            list="machine-tags"
            id="tag"
            placeholder="Digite ou selecione a TAG..."
            onchange="updateMachineInfo()"
        />

        <datalist id="machine-tags">
            <option value="EH-01">
            <option value="EH-02">
            <option value="EH-03">

            <option value="EH-4010">
            <option value="EH-4012">
            <option value="EH-4013">
            <option value="EH-4017">
            <option value="EH-4020">
            <option value="EH-4021">
            <option value="EH-4022">
            <option value="EH-4025">
            <option value="EH-4026">
            <option value="EH-4027">
            <option value="EH-4028">
            <option value="EH-4029">
            <option value="EH-4030">
            <option value="EH-4031">
            <option value="EH-4032">
            <option value="EH-4033">
            <option value="EH-4034">
            <option value="EH-4035">
            <option value="EH-4036">
            <option value="EH-4037">
            <option value="EH-4038">
            <option value="EH-4039">
            <option value="EH-4040">
            <option value="EH-4041">
            <option value="EH-4042">
            <option value="EH-4043">
            <option value="EH-4044">
            <option value="EH-4045">
            <option value="EH-4046">
            <option value="EH-4047">
            <option value="EH-4048">
            <option value="EH-4049">
            <option value="EH-4050">

            <option value="EH-5001">
            <option value="EH-5002">
            <option value="EH-5003">
            <option value="EH-5004">
            <option value="EH-5005">
            <option value="EH-5006">
            <option value="EH-5010">
            <option value="EH-5011">
            <option value="EH-5012">
            <option value="EH-5014">
            <option value="EH-5015">
            <option value="EH-5016">
            <option value="EH-5017">
            <option value="EH-5018">
            <option value="EH-5019">
            <option value="EH-5020">
            <option value="EH-5021">
            <option value="EH-5022">
            <option value="EH-5024">
            <option value="EH-5025">
            <option value="EH-5026">
            <option value="EH-5027">
            <option value="EH-5029">
            <option value="EH-5030">
            <option value="EH-5031">
            <option value="EH-5032">
            <option value="EH-5033">
            <option value="EH-5034">
            <option value="EH-5035">
            <option value="EH-5036">
            <option value="EH-5037">

            <option value="EH-6001">
            <option value="EH-6002">
            <option value="EH-6003">
            <option value="EH-6005">
            <option value="EH-6006">
            <option value="EH-6008">
            <option value="EH-6009">
            <option value="EH-6010">

            <option value="EH112">
            <option value="EH132">
            <option value="EH133">

            <option value="RED004">
            <option value="RED030">
            <option value="RED031">
            <option value="RED032">
            <option value="RED054">
        </datalist>
    </div>
</div>

                    <div class="machine-info-item">
                        <div class="machine-info-label">Modelo:</div>
                        <div style="position: relative; flex-grow: 1;">
                            <input type="text" class="machine-info-value form-control" id="modelo" placeholder="Digite o modelo">
                        </div>
                    </div>
                    <div class="machine-info-item">
                        <div class="machine-info-label">SN:</div>
                        <div style="position: relative; flex-grow: 1;">
                            <input type="text" class="machine-info-value form-control" id="sn" placeholder="Digite o número de série">
                        </div>
                    </div>
                    <div class="machine-info-item">
                        <div class="machine-info-label">Entrega:</div>
                        <div style="position: relative; flex-grow: 1;">
                            <input type="text" class="machine-info-value form-control" id="entrega" placeholder="Digite a data de entrega">
                        </div>
                    </div>
                    <div class="machine-info-item">
                        <div class="machine-info-label">Cliente:</div>
                        <div style="position: relative; flex-grow: 1;">
                            <input type="text" class="machine-info-value form-control" id="cliente" placeholder="Digite o nome do cliente">
                        </div>
                    </div>
                    <div class="machine-info-item">
                        <div class="machine-info-label">Descrição:</div>
                        <div style="position: relative; flex-grow: 1;">
                            <input type="text" class="machine-info-value form-control" id="descricao" placeholder="Digite a descrição">
                        </div>
                    </div>
                    <div class="machine-info-item">
                        <div class="machine-info-label">MACHINE DOWN?:</div>
                        <div style="position: relative; flex-grow: 1;">
                            <select class="machine-info-value form-select" id="machineDown">
                                <option value="" selected>Selecione...</option>
                                <option value="No">No</option>
                                <option value="Yes">Yes</option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Separator -->
                    <div class="section-separator">
                        <span>DADOS DA INSPEÇÃO</span>
                    </div>
                    
                    <!-- Inspection Information Section -->
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="date" class="form-label">Data da Inspeção</label>
                            <input type="date" class="form-control" id="date">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="inspector" class="form-label">Nome do Inspetor</label>
                            <div style="position: relative;">
                                <input type="text" class="form-control" id="inspector" placeholder="Digite o nome do inspetor">
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="hourmeter" class="form-label">Horímetro</label>
                            <div style="position: relative;">
                                <input type="text" class="form-control" id="hourmeter" placeholder="Digite o horímetro">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="footer">
                <p>&copy; 2023 - Departamento de Manutenção Industrial | Todos os direitos reservados</p>
            </div>
        </div>

        <!-- Slide 2: Contracapa -->
        <div class="slide back-cover" id="slide2">
            <div class="slide-content">
                <div class="header">
                    <div class="logo-area">
                        <img src="data:image/png;base64,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" alt="Logo">
                    </div>
                    <div class="inspection-badge">
                        <i class="fas fa-images me-2"></i>FOTOS
                    </div>
                </div>
                
                <h2 class="section-title">REGISTRO FOTOGRÁFICO</h2>
                
                <button class="btn btn-add-photos" onclick="togglePhotoCounter()">
                    <i class="fas fa-plus-circle me-2"></i>Adicionar Mais Fotos
                </button>
                
                <!-- Seção do contador de fotos -->
                <div class="photo-counter-section" id="photoCounterSection">
                    <div class="photo-counter-header">
                        <div class="photo-counter-title">
                            <i class="fas fa-images"></i>
                            <span>Quantidade de Fotos</span>
                        </div>
                        <button class="photo-counter-close" onclick="togglePhotoCounter()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="photo-counter-input-group">
                        <input type="number" class="form-control photo-counter-input" id="photoCountInput" 
                            min="2" max="100" step="2" placeholder="Digite a quantidade (número par)">
                        <div class="photo-counter-info">Será ajustado para o número par mais próximo</div>
                    </div>
                    <div class="photo-counter-actions">
                        <button class="btn btn-primary" onclick="addPhotosFromCounter()">
                            <i class="fas fa-check me-2"></i>Adicionar
                        </button>
                        <button class="btn btn-secondary" onclick="togglePhotoCounter()">
                            <i class="fas fa-times me-2"></i>Cancelar
                        </button>
                    </div>
                </div>
                
                <div class="photo-grid" id="photoGrid">
                    <!-- As fotos serão adicionadas dinamicamente aqui -->
                </div>
                
                <!-- Numero da Peça Table Section -->
                <div class="pn-table-section">
                    <h3><i class="fas fa-table"></i>Tabela de Peças (Numero da Peça)</h3>
                    <div class="table-responsive">
                        <table class="pn-table" id="pnTable">
                            <thead>
                                <tr>
                                    <th>Numero da Peça</th>
                                    <th>Nome da Peça</th>
                                    <th>Quantidade</th>
                                    <th>Foto Associada</th>
                                </tr>
                            </thead>
                            <tbody id="pnTableBody">
                                <!-- As linhas serão adicionadas dinamicamente aqui -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- Conclusão Section -->
                <div class="conclusion-section">
                    <h3><i class="fas fa-clipboard-check"></i>Conclusão</h3>
                    <div class="mb-3">
                        <textarea class="form-control" id="conclusion" rows="4" placeholder="Digite a conclusão do Relatório..."></textarea>
                    </div>
                </div>
             <button class="btn btn-clear-report" onclick="showClearConfirmation()">
                        <i class="fas fa-trash-alt me-2"></i>Limpar Relatório
                    </button>
                </div>
            </div>
            
            <div class="footer">
                <p>&copy; 2023 - Departamento de Manutenção Industrial | Todos os direitos reservados</p>
            </div>
        </div>
    </div>

    <!-- Photo Options Menu -->
    <div id="photoOptionsMenu" class="photo-options-menu">
        <h4 class="photo-options-title">Opções da Foto</h4>
        <button class="photo-option-btn" onclick="openCamera()">
            <i class="fas fa-camera"></i>
            Abrir Câmera
        </button>
        <button class="photo-option-btn" onclick="pasteFromClipboard()">
            <i class="fas fa-paste"></i>
            Colar Foto (Ctrl+V)
        </button>
        <button class="photo-option-btn" onclick="openFileSelector()">
            <i class="fas fa-upload"></i>
            Anexar Arquivo
        </button>
        <button class="photo-option-btn" id="fullscreenBtn" onclick="openFullscreen()" style="display: none;">
            <i class="fas fa-expand"></i>
            Visualizar em Tela Cheia
        </button>
        <button class="photo-option-btn" onclick="openPhotoEditor()">
            <i class="fas fa-edit"></i>
            Editar Foto
        </button>
        <button class="photo-option-btn photo-option-cancel" onclick="closePhotoOptions()">
            <i class="fas fa-times"></i>
            Cancelar
        </button>
    </div>

    <!-- Config Section -->
    <div class="config-section" id="configSection">
        <div class="config-header">
            <h5 class="config-title">
                <i class="fas fa-cog me-2"></i>Configurações
            </h5>
            <button class="config-close" onclick="toggleConfig()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="mb-3">
            <label for="reportTitle" class="form-label">Título do Relatório</label>
            <input type="text" class="form-control" id="reportTitle" placeholder="Insira o título do relatório">
        </div>
        
        <div class="mb-3">
            <label for="companyName" class="form-label">Nome da Empresa</label>
            <input type="text" class="form-control" id="companyName" placeholder="Insira o nome da empresa">
        </div>
        
        <div class="d-flex gap-2">
            <button class="btn btn-primary btn-sm flex-fill" onclick="saveConfig()">
                <i class="fas fa-save me-1"></i>Salvar
            </button>
            <button class="btn btn-warning btn-sm flex-fill" onclick="resetConfig()">
                <i class="fas fa-undo me-1"></i>Resetar
            </button>
        </div>
    </div>

    <!-- Fabric.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script>
    <!-- JSZip Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <!-- FileSaver.js Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <!-- PptxGenJS Library -->
    <script src="https://unpkg.com/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>

    <script>
        // ==================== CONFIGURAÇÕES GLOBAIS ====================
        const CONFIG = {
            BACKGROUND_IMAGE_URL: 'https://hitachikenki.scene7.com/is/image/hitachikenki/EX2600-7-1-1-e1645300696881-1:4-3?wid=800&hei=600',
            FALLBACK_IMAGES: [
                'https://images.unsplash.com/photo-1581094794329-c8112a89af12?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1740&q=80',
                'https://images.unsplash.com/photo-1558618666-fcd25c85cd64?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1740&q=80'
            ],
            AUTO_SAVE_INTERVAL: 30000, // 30 segundos
            INITIAL_PHOTO_COUNT: 4,
            MAX_PHOTO_COUNT: 100,
           MACHINE_DATA: {
    'EH-01': {
        modelo: 'EX2600-7',
        sn: '',
        entrega: '2022',
        cliente: 'Lundin'
    },
    'EH-02': {
        modelo: 'EX2600-7',
        sn: '',
        entrega: '2023',
        cliente: 'Lundin'
    },
    'EH-03': {
        modelo: 'EX2600-7',
        sn: '',
        entrega: '2023',
        cliente: 'Lundin'
    },

    'EH-4034': {
        modelo: 'EX1200-7',
        sn: '',
        entrega: '2021',
        cliente: 'U&M'
    },
    'EH-5006': {
        modelo: 'EX2500-6',
        sn: '',
        entrega: '2008',
        cliente: 'U&M'
    },
    'EH-5012': {
        modelo: 'EX2600-6',
        sn: '',
        entrega: '2012',
        cliente: 'U&M'
    },
    'EH-5035': {
        modelo: 'EX2600-7',
        sn: '',
        entrega: '2021',
        cliente: 'U&M'
    },
    'EH-6003': {
        modelo: 'EX5500-5',
        sn: '',
        entrega: '2008',
        cliente: 'U&M'
    },
    'EH-6005': {
        modelo: 'EX5500-5',
        sn: '',
        entrega: '2002',
        cliente: 'U&M'
    },
    'EH-4010': {
        modelo: 'EX1200-5',
        sn: '',
        entrega: '2008',
        cliente: 'U&M'
    },
    'EH-4012': {
        modelo: 'EX1200-6',
        sn: '',
        entrega: '2008',
        cliente: 'U&M'
    },
    'EH-4013': {
        modelo: 'EX1200-6',
        sn: '',
        entrega: '2008',
        cliente: 'U&M'
    },
    'EH-4017': {
        modelo: 'EX1200-6',
        sn: '',
        entrega: '2009',
        cliente: 'U&M'
    },
    'EH-4022': {
        modelo: 'EX1200-6',
        sn: '',
        entrega: '2011',
        cliente: 'U&M'
    },
    'EH-4037': {
        modelo: 'EX1200-7',
        sn: '',
        entrega: '2021',
        cliente: 'U&M'
    },
    'EH-4038': {
        modelo: 'EX1200-7',
        sn: '',
        entrega: '2021',
        cliente: 'U&M'
    },
    'EH-4040': {
        modelo: 'EX1200-7',
        sn: '',
        entrega: '2022',
        cliente: 'U&M'
    },
    'EH-4043': {
        modelo: 'EX1200-7',
        sn: '',
        entrega: '2022',
        cliente: 'U&M'
    },

    'EH112': {
        modelo: 'EX2600-7',
        sn: '',
        entrega: '2024',
        cliente: 'R&D'
    },
    'RED004': {
        modelo: 'EX2600-7',
        sn: '',
        entrega: '2023',
        cliente: 'R&D'
    },
    'RED030': {
        modelo: 'EH4000-AC3',
        sn: '',
        entrega: '2024',
        cliente: 'R&D'
    },
    'RED031': {
        modelo: 'EH4000-AC3',
        sn: '',
        entrega: '2024',
        cliente: 'R&D'
    },
    'RED032': {
        modelo: 'EH4000-AC3',
        sn: '',
        entrega: '2024',
        cliente: 'R&D'
    },
    'RED054': {
        modelo: 'EX2600-7',
        sn: '',
        entrega: '2023',
        cliente: 'R&D'
    },
    'EH132': {
        modelo: 'EX1200-7',
        sn: '',
        entrega: '2024',
        cliente: 'R&D'
    },
    'EH133': {
        modelo: 'EX1200-7',
        sn: '',
        entrega: '2024',
        cliente: 'R&D'
    }
},
TRANSLATE_CACHE_KEY: 'translationCache'
};


        // ==================== VARIÁVEIS GLOBAIS ====================
        let cachedBackgroundImage = null;
        let photoCount = CONFIG.INITIAL_PHOTO_COUNT;
        let lastSaveTime = null;
        let autoSaveInterval = null;
        let photoEditor = null;
        let currentEditingPhotoIndex = null;
        let currentPhotoIndex = null;
        let fullscreenIndex = 0;
        let fullscreenImages = [];
        let eventListeners = {};
        let detectionMode = false;
        let detectedTextElements = [];
        let translationCache = {};
        let currentTranslation = null; // Armazena a tradução atual para usar no PowerPoint

        // ==================== MÓDULO DE TRADUÇÃO ====================
        const TranslationManager = {
            cache: {},
            
            loadCache: function() {
                const cached = localStorage.getItem(CONFIG.TRANSLATE_CACHE_KEY);
                if (cached) {
                    try {
                        this.cache = JSON.parse(cached);
                    } catch (error) {
                        console.error('Erro ao carregar cache de tradução:', error);
                        this.cache = {};
                    }
                }
            },
            
            saveCache: function() {
                localStorage.setItem(CONFIG.TRANSLATE_CACHE_KEY, JSON.stringify(this.cache));
            },
            
            getTranslation: function(text, sourceLang, targetLang) {
                const key = `${sourceLang}-${targetLang}-${text}`;
                return this.cache[key] || null;
            },
            
            setTranslation: function(text, sourceLang, targetLang, translation) {
                const key = `${sourceLang}-${targetLang}-${text}`;
                this.cache[key] = translation;
                this.saveCache();
            },
            
            // Função para traduzir usando API externa
            translateWithAPI: async function(text, sourceLang, targetLang) {
                try {
                    // Usando a API gratuita de MyMemory Translation
                    const url = `https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${sourceLang}|${targetLang}`;
                    
                    const response = await fetch(url);
                    const data = await response.json();
                    
                    if (data.responseStatus === 200 && data.responseData.translatedText) {
                        const translation = data.responseData.translatedText;
                        
                        // Salvar no cache
                        this.setTranslation(text, sourceLang, targetLang, translation);
                        
                        return translation;
                    } else {
                        throw new Error('Tradução não encontrada na API');
                    }
                } catch (error) {
                    console.error('Erro na API de tradução:', error);
                    
                    // Tentar fallback com Google Translate (requer proxy)
                    try {
                        return await this.translateWithGoogleProxy(text, sourceLang, targetLang);
                    } catch (proxyError) {
                        console.error('Erro no proxy de tradução:', proxyError);
                        throw error;
                    }
                }
            },
            
            // Fallback usando proxy CORS para Google Translate
            translateWithGoogleProxy: async function(text, sourceLang, targetLang) {
                const proxyUrl = 'https://cors-anywhere.herokuapp.com/https://translate.googleapis.com/translate_a/single';
                const params = new URLSearchParams({
                    client: 'gtx',
                    sl: sourceLang,
                    tl: targetLang,
                    dt: 't',
                    q: text
                });
                
                const response = await fetch(`${proxyUrl}?${params.toString()}`, {
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                });
                
                const data = await response.json();
                
                if (data && data[0] && data[0][0] && data[0][0][0]) {
                    const translation = data[0][0][0];
                    
                    // Salvar no cache
                    this.setTranslation(text, sourceLang, targetLang, translation);
                    
                    return translation;
                } else {
                    throw new Error('Formato de resposta inválido do Google Translate');
                }
            },
            
            // Dicionário de traduções pré-definidas (mantido como fallback)
            translations: {
                'pt-en': {
                    'TAG': 'TAG',
                    'Modelo': 'Model',
                    'SN': 'SN',
                    'Entrega': 'Delivery',
                    'Cliente': 'Customer',    // Alterado de 'Client' para 'Customer'
                    'Descrição': 'Description',
                    'MACHINE DOWN?': 'MACHINE DOWN?',
                    'DADOS DA INSPEÇÃO': 'INSPECTION DATA',
                    'Data da Inspeção': 'Inspection Date',
                    'Nome do Inspetor': 'Inspector Name',
                    'Horímetro': 'Hour Meter',
                    'REGISTRO FOTOGRÁFICO': 'PHOTOGRAPHIC RECORD',
                    'Adicionar Mais Fotos': 'Add More Photos',
                    'Adicionar': 'Add',
                    'Cancelar': 'Cancel',
                    'Finalizar Relatório': 'Finalize Report',
                    'Limpar Relatório': 'Clear Report',
                    'PN:': 'PN:',
                    'Peça:': 'Part:',
                    'Qtd:': 'Qty:',
                    'Adicione uma descrição detalhada da foto...': 'Add a detailed description of the photo...',
                    'Selecione...': 'Select...',
                    'Relatório Técnico': 'Technical Report',
                    'Informações da Inspeção': 'Inspection Information',
                    'Quantidade de Fotos': 'Number of Photos',
                    'Será ajustado para o número par mais próximo': 'Will be adjusted to the nearest even number',
                    'Digite a quantidade (número par)': 'Enter the quantity (even number)',
                    'Clique para adicionar uma foto': 'Click to add a photo',
                    'Obrigatório': 'Required',
                    'Nome da peça': 'Part name',
                    'Quantidade': 'Quantity',
                    'Opções da Foto': 'Photo Options',
                    'Abrir Câmera': 'Open Camera',
                    'Colar Foto (Ctrl+V)': 'Paste Photo (Ctrl+V)',
                    'Anexar Arquivo': 'Attach File',
                    'Visualizar em Tela Cheia': 'View Fullscreen',
                    'Editar Foto': 'Edit Photo',
                    'Editor de Foto': 'Photo Editor',
                    'Selecionar': 'Select',
                    'Caneta': 'Pen',
                    'Círculo': 'Circle',
                    'Retângulo': 'Rectangle',
                    'Seta': 'Arrow',
                    'Texto': 'Text',
                    'Excluir Selecionado': 'Delete Selected',
                    'Limpar Edições': 'Clear Edits',
                    'Salvar': 'Save',
                    'Foto': 'Photo',
                    'de': 'of',
                    'amor': 'love',
                    'Conclusão': 'Conclusion',
                    'Digite a conclusão do Relatório...': 'Enter the Report conclusion...',
                    
                    // Traduções para as perguntas e opções do formulário
                    'A falha estava ativa quando chegou no equipamento?': 'Was the failure active when it arrived at the equipment?',
                    'É uma ocorrência reincidente (já aconteceu antes no mesmo ponto)?': 'Is it a recurring occurrence (has it happened before at the same point)?',
                    'Foi possível confirmar o ponto exato de origem?': 'Was it possible to confirm the exact point of origin?',
                    'Tipo de problema': 'Type of problem',
                    'Vazamento': 'Leak',
                    'Trinca': 'Crack',
                    'Desgaste': 'Wear',
                    'Folga': 'Clearance',
                    'Ruído': 'Noise',
                    'Quebra': 'Break',
                    'Corrosão': 'Corrosion',
                    'Outro': 'Other',
                    'Severidade': 'Severity',
                    'Crítico': 'Critical',
                    'Moderado': 'Moderate',
                    'Leve': 'Light',
                    'Sistema afetado': 'Affected system',
                    'Hidráulico': 'Hydraulic',
                    'Elétrico': 'Electrical',
                    'Estrutural': 'Structural',
                    'Lubrificação': 'Lubrication',
                    'Qual é a possível causa do problema?': 'What is the possible cause of the problem?',
                    'Qual é o ponto exato de origem?': 'What is the exact point of origin?',
                    'Há código de falha ativo? Qual?': 'Is there an active fault code? Which one?',
                    'Houve substituição de componente?': 'Was there a component replacement?',
                    'Foi realizado teste após a intervenção?': 'Was a test performed after the intervention?',
                    'A falha foi totalmente corrigida?': 'Was the failure completely corrected?',
                    'Existe risco de reincidência mesmo após o reparo?': 'Is there a risk of recurrence even after the repair?',
                    'Tipo de ação imediata': 'Type of immediate action',
                    'Limpeza': 'Cleaning',
                    'Reaperto': 'Tightening',
                    'Substituição': 'Replacement',
                    'Isolamento': 'Isolation',
                    'Drenagem': 'Drainage',
                    'Travamento': 'Locking',
                    'Destino da peça removida': 'Destination of the removed part',
                    'Enviada para análise': 'Sent for analysis',
                    'Descartada em campo': 'Discarded in the field',
                    'Peça recolhida pelo cliente': 'Part collected by the customer',
                    'Tipo de teste realizado': 'Type of test performed',
                    'Pressão': 'Pressure',
                    'Estanqueidade': 'Tightness',
                    'Funcional': 'Functional',
                    'Operacional': 'Operational',
                    'Qual componente foi trocado ou mantido?': 'Which component was replaced or kept?',
                    'Quais ações foram realizadas em detalhe?': 'What actions were performed in detail?',
                    'Resultado do teste': 'Test result',
                    'Códigos de falha após testes': 'Fault codes after tests',
                    'Parâmetros medidos pós resolução do problema': 'Parameters measured after problem resolution',
                    'Inspeção pós-aquecimento (vazamentos e reapertos)': 'Post-heating inspection (leaks and retightening)',
                    'É necessário monitoramento periódico?': 'Is periodic monitoring necessary?',
                    'Recomenda-se substituir outros componentes próximos?': 'Is it recommended to replace other nearby components?',
                    'Está relacionada a outra ocorrência recente?': 'Is it related to another recent occurrence?',
                    'Algum operador relatou sintomas antes da falha?': 'Did any operator report symptoms before the failure?',
                    'O histórico anterior mostra ocorrência semelhante?': 'Does the previous history show similar occurrence?',
                    'Condições adversas': 'Adverse conditions',
                    'Chuva': 'Rain',
                    'Lama': 'Mud',
                    'Alta temperatura': 'High temperature',
                    'Turno noturno': 'Night shift',
                    'Sintomas relatados': 'Reported symptoms',
                    'Vibração': 'Vibration',
                    'Lentidão': 'Slowness',
                    'Aquecimento': 'Heating',
                    'Evidências visuais': 'Visual evidence',
                    'Respingo': 'Splash',
                    'Marcas de atrito': 'Friction marks',
                    'Cheiro de fluido': 'Fluid smell',
                    'Resíduos metálicos': 'Metallic residues',
                    'Detalhar relação com ocorrência anterior caso houver': 'Detail relationship with previous occurrence if any',
                    '1) Situação Observada': '1) Observed Situation',
                    '2) Ações Realizadas': '2) Actions Taken',
                    '3) Validação e Resultado': '3) Validation and Result',
                    '4) Recomendações / Próximos Passos': '4) Recommendations / Next Steps',
                    '5) Observações Adicionais': '5) Additional Observations',
                    
                    // 🔥 NOVAS: Cabeçalhos da tabela
                    'Numero da Peça': 'Part Number',
                    'Nome da Peça': 'Part Name',
                    'Quantidade': 'Quantity',
                    'Foto Associada': 'Associated Photo',
                    
                    // 🔥 NOVAS: Rótulos das informações da foto
                    'Numero da Peça:': 'Part Number:',
                    'Peça:': 'Part:',
                    'Qtd:': 'Qty:',
                    
                    // 🔥 NOVAS: Placeholders comuns
                    'Descreva a possível causa do problema identificado': 'Describe the possible cause of the identified problem',
                    'Descreva o local exato onde o problema foi identificado': 'Describe the exact location where the problem was identified',
                    'Informe o código de falha, se houver': 'Enter the fault code, if any',
                    'Descreva detalhadamente o componente que foi trocado ou mantido': 'Describe in detail the component that was replaced or kept',
                    'Descreva em detalhes todas as ações realizadas': 'Describe in detail all actions performed',
                    'Descreva o resultado obtido nos testes realizados': 'Describe the result obtained in the tests performed',
                    'Informe se os códigos de falha foram limpos ou persistem': 'Inform if the fault codes were cleared or persist',
                    'Descreva os parâmetros medidos após a resolução': 'Describe the parameters measured after the resolution',
                    'Descreva o resultado da inspeção após aquecimento': 'Describe the result of the inspection after heating',
                    'Descreva a relação com ocorrências anteriores, se aplicável': 'Describe the relationship with previous occurrences, if applicable',
                    
                    // Tradução para números
                    '40': '40',
                    '46': '46',
                    '50': '50',
                    '54': '54',
                    '58': '58',
                    '6': '6',
                    '7': '7',
                    '8': '8',
                    '9': '9',
                    '10': '10',
                    '11': '11',
                    '12': '12',
                    '13': '13',
                    '14': '14',
                    '15': '15',
                    '16': '16',
                    '17': '17',
                    '18': '18'
                },
                'pt-ja': {
                    'amor': '愛',
                    'Numero da Peça': '部品番号',
                    'Nome da Peça': '部品名',
                    'Quantidade': '数量',
                    'Foto Associada': '関連写真',
                    'Conclusão': '結論'
                },
                'en-pt': {
                    'love': 'amor',
                    
                    // Traduções reversas para as perguntas e opções do formulário
                    'Was the failure active when it arrived at the equipment?': 'A falha estava ativa quando chegou no equipamento?',
                    'Is it a recurring occurrence (has it happened before at the same point)?': 'É uma ocorrência reincidente (já aconteceu antes no mesmo ponto)?',
                    'Was it possible to confirm the exact point of origin?': 'Foi possível confirmar o ponto exato de origem?',
                    'Type of problem': 'Tipo de problema',
                    'Leak': 'Vazamento',
                    'Crack': 'Trinca',
                    'Wear': 'Desgaste',
                    'Clearance': 'Folga',
                    'Noise': 'Ruído',
                    'Break': 'Quebra',
                    'Corrosion': 'Corrosão',
                    'Other': 'Outro',
                    'Severity': 'Severidade',
                    'Critical': 'Crítico',
                    'Moderate': 'Moderado',
                    'Light': 'Leve',
                    'Affected system': 'Sistema afetado',
                    'Hydraulic': 'Hidráulico',
                    'Electrical': 'Elétrico',
                    'Structural': 'Estrutural',
                    'Lubrication': 'Lubrificação',
                    'What is the possible cause of the problem?': 'Qual é a possível causa do problema?',
                    'What is the exact point of origin?': 'Qual é o ponto exato de origem?',
                    'Is there an active fault code? Which one?': 'Há código de falha ativo? Qual?',
                    'Was there a component replacement?': 'Houve substituição de componente?',
                    'Was a test performed after the intervention?': 'Foi realizado teste após a intervenção?',
                    'Was the failure completely corrected?': 'A falha foi totalmente corrigida?',
                    'Is there a risk of recurrence even after the repair?': 'Existe risco de reincidência mesmo após o reparo?',
                    'Type of immediate action': 'Tipo de ação imediata',
                    'Cleaning': 'Limpeza',
                    'Tightening': 'Reaperto',
                    'Replacement': 'Substituição',
                    'Isolation': 'Isolamento',
                    'Drainage': 'Drenagem',
                    'Locking': 'Travamento',
                    'Destination of the removed part': 'Destino da peça removida',
                    'Sent for analysis': 'Enviada para análise',
                    'Discarded in the field': 'Descartada em campo',
                    'Part collected by the customer': 'Peça recolhida pelo cliente',
                    'Type of test performed': 'Tipo de teste realizado',
                    'Pressure': 'Pressão',
                    'Tightness': 'Estanqueidade',
                    'Functional': 'Funcional',
                    'Operational': 'Operacional',
                    'Which component was replaced or kept?': 'Qual componente foi trocado ou mantido?',
                    'What actions were performed in detail?': 'Quais ações foram realizadas em detalhe?',
                    'Test result': 'Resultado do teste',
                    'Fault codes after tests': 'Códigos de falha após testes',
                    'Parameters measured after problem resolution': 'Parâmetros medidos pós resolução do problema',
                    'Post-heating inspection (leaks and retightening)': 'Inspeção pós-aquecimento (vazamentos e reapertos)',
                    'Is periodic monitoring necessary?': 'É necessário monitoramento periódico?',
                    'Is it recommended to replace other nearby components?': 'Recomenda-se substituir outros componentes próximos?',
                    'Is it related to another recent occurrence?': 'Está relacionada a outra ocorrência recente?',
                    'Did any operator report symptoms before the failure?': 'Algum operador relatou sintomas antes da falha?',
                    'Does the previous history show similar occurrence?': 'O histórico anterior mostra ocorrência semelhante?',
                    'Adverse conditions': 'Condições adversas',
                    'Rain': 'Chuva',
                    'Mud': 'Lama',
                    'High temperature': 'Alta temperatura',
                    'Night shift': 'Turno noturno',
                    'Reported symptoms': 'Sintomas relatados',
                    'Vibration': 'Vibração',
                    'Slowness': 'Lentidão',
                    'Heating': 'Aquecimento',
                    'Visual evidence': 'Evidências visuais',
                    'Splash': 'Respingo',
                    'Friction marks': 'Marcas de atrito',
                    'Fluid smell': 'Cheiro de fluido',
                    'Metallic residues': 'Resíduos metálicos',
                    'Detail relationship with previous occurrence if any': 'Detalhar relação com ocorrência anterior caso houver',
                    '1) Observed Situation': '1) Situação Observada',
                    '2) Actions Taken': '2) Ações Realizadas',
                    '3) Validation and Result': '3) Validação e Resultado',
                    '4) Recommendations / Next Steps': '4) Recomendações / Próximos Passos',
                    '5) Additional Observations': '5) Observações Adicionais',
                    
                    // 🔥 NOVAS: Cabeçalhos da tabela (tradução reversa)
                    'Part Number': 'Numero da Peça',
                    'Part Name': 'Nome da Peça',
                    'Quantity': 'Quantidade',
                    'Associated Photo': 'Foto Associada',
                    
                    // 🔥 NOVAS: Rótulos das informações da foto (tradução reversa)
                    'Part Number:': 'Numero da Peça:',
                    'Part:': 'Peça:',
                    'Qty:': 'Qtd:',
                    
                    // 🔥 NOVAS: Placeholders comuns (tradução reversa)
                    'Describe the possible cause of the identified problem': 'Descreva a possível causa do problema identificado',
                    'Describe the exact location where the problem was identified': 'Descreva o local exato onde o problema foi identificado',
                    'Enter the fault code, if any': 'Informe o código de falha, se houver',
                    'Describe in detail the component that was replaced or kept': 'Descreva detalhadamente o componente que foi trocado ou mantido',
                    'Describe in detail all actions performed': 'Descreva em detalhes todas as ações realizadas',
                    'Describe the result obtained in the tests performed': 'Descreva o resultado obtido nos testes realizados',
                    'Inform if the fault codes were cleared or persist': 'Informe se os códigos de falha foram limpos ou persistem',
                    'Describe the parameters measured after the resolution': 'Descreva os parâmetros medidos após a resolução',
                    'Describe the result of the inspection after heating': 'Descreva o resultado do após aquecimento',
                    'Describe the relationship with previous occurrences, if applicable': 'Descreva a relação com ocorrências anteriores, se aplicável',
                    'Conclusion': 'Conclusão',
                    'Enter the report conclusion...': 'Digite a conclusão da relatório...'
                },
                'en-ja': {
                    'love': '愛',
                    'Part Number': '部品番号',
                    'Part Name': '部品名',
                    'Quantity': '数量',
                    'Associated Photo': '関連写真',
                    'Conclusion': '結論'
                },
                'ja-pt': {
                    '愛': 'amor',
                    '部品番号': 'Numero da Peça',
                    '部品名': 'Nome da Peça',
                    '数量': 'Quantidade',
                    '関連写真': 'Foto Associada',
                    '結論': 'Conclusão'
                },
                'ja-en': {
                    '愛': 'love',
                    '部品番号': 'Part Number',
                    '部品名': 'Part Name',
                    '数量': 'Quantity',
                    '関連写真': 'Associated Photo',
                    '結論': 'Conclusion'
                }
            },
            
            translateText: async function(text, sourceLang, targetLang) {
                return new Promise(async (resolve, reject) => {
                    // Verificar se já temos no cache
                    const cachedTranslation = this.getTranslation(text, sourceLang, targetLang);
                    if (cachedTranslation) {
                        resolve(cachedTranslation);
                        return;
                    }
                    
                    // Verificar se temos no dicionário pré-definido
                    const key = `${sourceLang}-${targetLang}`;
                    if (this.translations[key] && this.translations[key][text]) {
                        const translation = this.translations[key][text];
                        
                        // Salvar no cache
                        this.setTranslation(text, sourceLang, targetLang, translation);
                        
                        resolve(translation);
                        return;
                    }
                    
                    // Tentar traduzir com API externa
                    try {
                        const translation = await this.translateWithAPI(text, sourceLang, targetLang);
                        resolve(translation);
                    } catch (error) {
                        console.error('Erro ao traduzir com API:', error);
                        
                        // Se falhar, verificar se temos tradução reversa no dicionário
                        const reverseKey = `${targetLang}-${sourceLang}`;
                        if (this.translations[reverseKey]) {
                            // Procurar o texto como tradução no dicionário reverso
                            for (const [original, translated] of Object.entries(this.translations[reverseKey])) {
                                if (translated.toLowerCase() === text.toLowerCase()) {
                                    resolve(original);
                                    return;
                                }
                            }
                        }
                        
                        // Último fallback: tentar tradução simples para palavras comuns
                        const simpleTranslation = this.getSimpleTranslation(text, sourceLang, targetLang);
                        if (simpleTranslation) {
                            this.setTranslation(text, sourceLang, targetLang, simpleTranslation);
                            resolve(simpleTranslation);
                        } else {
                            // Se não encontrar nada, retorna o texto original com aviso
                            console.warn(`Tradução não encontrada para: "${text}" (${sourceLang} -> ${targetLang})`);
                            resolve(text);
                        }
                    }
                });
            },
            
            // Traduções simples para palavras comuns
            getSimpleTranslation: function(text, sourceLang, targetLang) {
                const commonWords = {
                    'pt-en': {
                        'amor': 'love',
                        'casa': 'house',
                        'carro': 'car',
                        'trabalho': 'work',
                        'família': 'family',
                        'amigo': 'friend',
                        'tempo': 'time',
                        'dia': 'day',
                        'noite': 'night',
                        'água': 'water',
                        'comida': 'food',
                        'feliz': 'happy',
                        'triste': 'sad',
                        'grande': 'big',
                        'pequeno': 'small',
                        'bom': 'good',
                        'mau': 'bad'
                    },
                    'en-pt': {
                        'love': 'amor',
                        'house': 'casa',
                        'car': 'carro',
                        'work': 'trabalho',
                        'family': 'família',
                        'friend': 'amigo',
                        'time': 'tempo',
                        'day': 'dia',
                        'night': 'noite',
                        'water': 'água',
                        'food': 'comida',
                        'happy': 'feliz',
                        'sad': 'triste',
                        'big': 'grande',
                        'small': 'pequeno',
                        'good': 'bom',
                        'bad': 'mau'
                    }
                };
                
                const key = `${sourceLang}-${targetLang}`;
                return commonWords[key] && commonWords[key][text.toLowerCase()] 
                    ? commonWords[key][text.toLowerCase()] 
                    : null;
            },
            
            detectTextElements: function() {
                const options = {
                    detectLabels: document.getElementById('detectLabels').checked,
                    detectPlaceholders: document.getElementById('detectPlaceholders').checked,
                    detectButtons: document.getElementById('detectButtons').checked,
                    detectInputs: document.getElementById('detectInputs').checked,
                    detectDescriptions: document.getElementById('detectDescriptions').checked
                };
                
                detectedTextElements = [];
                
                // Limpar destaques anteriores
                document.querySelectorAll('.highlighted-element').forEach(el => {
                    el.classList.remove('highlighted-element');
                    const badge = el.querySelector('.text-badge');
                    if (badge) badge.remove();
                });
                
                let elementIndex = 0;
                
                // Detectar rótulos e títulos
                if (options.detectLabels) {
                    document.querySelectorAll('h1, h2, h3, h4, h5, h6, .form-label, .machine-info-label, .photo-info-label, .section-title, .cover-title').forEach((el) => {
                        if (el.textContent.trim()) {
                            detectedTextElements.push({
                                element: el,
                                type: 'label',
                                text: el.textContent.trim()
                            });
                            
                            // Adicionar destaque visual
                            el.classList.add('highlighted-element');
                            
                            // Adicionar badge
                            const badge = document.createElement('span');
                            badge.className = 'text-badge';
                            badge.textContent = ++elementIndex;
                            el.style.position = 'relative';
                            el.appendChild(badge);
                        }
                    });
                }
                
                // Detectar placeholders
                if (options.detectPlaceholders) {
                    document.querySelectorAll('input[placeholder], textarea[placeholder]').forEach((el) => {
                        if (el.placeholder.trim()) {
                            detectedTextElements.push({
                                element: el,
                                type: 'placeholder',
                                text: el.placeholder.trim(),
                                property: 'placeholder'
                            });
                            
                            // Adicionar destaque visual
                            el.classList.add('highlighted-element');
                            
                            // Adicionar badge
                            const badge = document.createElement('span');
                            badge.className = 'text-badge';
                            badge.textContent = ++elementIndex;
                            el.parentElement.style.position = 'relative';
                            el.parentElement.appendChild(badge);
                        }
                    });
                }
                
                // Detectar botões
                if (options.detectButtons) {
                    document.querySelectorAll('button, .btn').forEach((el) => {
                        if (el.textContent.trim()) {
                            detectedTextElements.push({
                                element: el,
                                type: 'button',
                                text: el.textContent.trim()
                            });
                            
                            // Adicionar destaque visual
                            el.classList.add('highlighted-element');
                            
                            // Adicionar badge
                            const badge = document.createElement('span');
                            badge.className = 'text-badge';
                            badge.textContent = ++elementIndex;
                            el.style.position = 'relative';
                            el.appendChild(badge);
                        }
                    });
                }
                
                // 🔥 MELHORIA: Detectar campos de entrada (incluindo valores atuais)
                if (options.detectInputs) {
                    document.querySelectorAll('input:not([placeholder]), textarea:not([placeholder]), select').forEach((el) => {
                        // 🔥 NOVO: Detectar tanto valores quanto placeholders vazios
                        const hasValue = el.value && el.value.trim();
                        const hasPlaceholder = el.placeholder && el.placeholder.trim();
                        
                        if (hasValue || hasPlaceholder) {
                            const textToTranslate = hasValue ? el.value.trim() : el.placeholder.trim();
                            
                            detectedTextElements.push({
                                element: el,
                                type: 'input',
                                text: textToTranslate,
                                property: hasValue ? 'value' : 'placeholder'
                            });
                            
                            // Adicionar destaque visual
                            el.classList.add('highlighted-element');
                            
                            // Adicionar badge
                            const badge = document.createElement('span');
                            badge.className = 'text-badge';
                            badge.textContent = ++elementIndex;
                            
                            // Posicionar o badge de forma adequada
                            if (el.parentElement) {
                                el.parentElement.style.position = 'relative';
                                el.parentElement.appendChild(badge);
                            } else {
                                el.style.position = 'relative';
                                el.appendChild(badge);
                            }
                        }
                    });
                    
                    // 🔥 NOVO: Detectar especificamente os campos de informações das fotos
                    document.querySelectorAll('[data-field]').forEach((el) => {
                        if (el.value && el.value.trim()) {
                            detectedTextElements.push({
                                element: el,
                                type: 'photo-field',
                                text: el.value.trim(),
                                property: 'value'
                            });
                            
                            // Adicionar destaque visual
                            el.classList.add('highlighted-element');
                            
                            // Adicionar badge
                            const badge = document.createElement('span');
                            badge.className = 'text-badge';
                            badge.textContent = ++elementIndex;
                            
                            // Posicionar o badge de forma adequada
                            if (el.parentElement) {
                                el.parentElement.style.position = 'relative';
                                el.parentElement.appendChild(badge);
                            } else {
                                el.style.position = 'relative';
                                el.appendChild(badge);
                            }
                        }
                    });
                }
                
                // Detectar descrições
                if (options.detectDescriptions) {
                    document.querySelectorAll('p, .description, .photo-description textarea').forEach((el) => {
                        const text = el.tagName === 'TEXTAREA' ? el.value.trim() : el.textContent.trim();
                        if (text) {
                            detectedTextElements.push({
                                element: el,
                                type: 'description',
                                text: text,
                                property: el.tagName === 'TEXTAREA' ? 'value' : 'textContent'
                            });
                            
                            // Adicionar destaque visual
                            el.classList.add('highlighted-element');
                            
                            // Adicionar badge
                            const badge = document.createElement('span');
                            badge.className = 'text-badge';
                            badge.textContent = ++elementIndex;
                            el.style.position = 'relative';
                            el.appendChild(badge);
                        }
                    });
                }
                
                // 🔥 NOVO: Detectar cabeçalhos da tabela
                document.querySelectorAll('.pn-table th').forEach((el, index) => {
                    const text = el.textContent.trim();
                    if (text) {
                        detectedTextElements.push({
                            element: el,
                            type: 'table-header',
                            text: text,
                            property: 'textContent',
                            index: index
                        });
                        
                        // Adicionar destaque visual
                        el.classList.add('highlighted-element');
                        
                        // Adicionar badge
                        const badge = document.createElement('span');
                        badge.className = 'text-badge';
                        badge.textContent = ++elementIndex;
                        el.style.position = 'relative';
                        el.appendChild(badge);
                    }
                });
                
                // 🔥 NOVO: Detectar campo de conclusão
                const conclusionField = document.getElementById('conclusion');
                if (conclusionField && conclusionField.value && conclusionField.value.trim()) {
                    detectedTextElements.push({
                        element: conclusionField,
                        type: 'conclusion',
                        text: conclusionField.value.trim(),
                        property: 'value'
                    });
                    
                    // Adicionar destaque visual
                    conclusionField.classList.add('highlighted-element');
                    
                    // Adicionar badge
                    const badge = document.createElement('span');
                    badge.className = 'text-badge';
                    badge.textContent = ++elementIndex;
                    
                    // Posicionar o badge de forma adequada
                    if (conclusionField.parentElement) {
                        conclusionField.parentElement.style.position = 'relative';
                        conclusionField.parentElement.appendChild(badge);
                    }
                }
                
                return detectedTextElements;
            },

            // 🔥 NOVA FUNÇÃO - Adicione esta função logo após a função detectTextElements
            forceTranslateAllDynamicFields: async function(sourceLang, targetLang) {
                // Forçar a tradução de todos os campos dinâmicos
                const dynamicFields = [
                    'modelo', 'sn', 'tag', 'entrega', 'cliente', 'descricao', 
                    'machineDown', 'data', 'inspetor', 'horimetro'
                ];
                
                for (const fieldId of dynamicFields) {
                    const element = document.getElementById(fieldId);
                    if (element && element.value && element.value.trim()) {
                        try {
                            const translation = await this.translateText(element.value, sourceLang, targetLang);
                            element.value = translation;
                        } catch (error) {
                            console.error(`Erro ao traduzir campo ${fieldId}:`, error);
                        }
                    }
                }
                
                // Forçar a tradução de todos os campos de informações das fotos
                const photoFields = document.querySelectorAll('[data-field]');
                for (const el of photoFields) {
                    if (el.value && el.value.trim()) {
                        try {
                            const translation = await this.translateText(el.value, sourceLang, targetLang);
                            el.value = translation;
                        } catch (error) {
                            console.error('Erro ao traduzir campo de foto:', error);
                        }
                    }
                }
                
                // Forçar a tradução de todas as descrições de fotos
                const photoDescriptions = document.querySelectorAll('.photo-description textarea');
                for (const el of photoDescriptions) {
                    if (el.value && el.value.trim()) {
                        try {
                            const translation = await this.translateText(el.value, sourceLang, targetLang);
                            el.value = translation;
                        } catch (error) {
                            console.error('Erro ao traduzir descrição de foto:', error);
                        }
                    }
                }
                
                // Forçar a tradução do campo de conclusão
                const conclusionField = document.getElementById('conclusion');
                if (conclusionField && conclusionField.value && conclusionField.value.trim()) {
                    try {
                        const translation = await this.translateText(conclusionField.value, sourceLang, targetLang);
                        conclusionField.value = translation;
                    } catch (error) {
                        console.error('Erro ao traduzir campo de conclusão:', error);
                    }
                }
            },

            translateAllElements: async function(sourceLang, targetLang) {
                if (detectedTextElements.length === 0) {
                    this.detectTextElements();
                }
                
                if (detectedTextElements.length === 0) {
                    UIController.showNotification('Nenhum elemento de texto encontrado para traduzir', 'warning');
                    return;
                }
                
                UIController.showLoading('Traduzindo textos...');
                
                const totalElements = detectedTextElements.length;
                let translatedElements = 0;
                
                // Armazenar informações de tradução para usar no PowerPoint
                currentTranslation = {
                    sourceLang: sourceLang,
                    targetLang: targetLang,
                    translations: {}
                };
                
                // Atualizar status
                document.getElementById('translationStatus').textContent = `Traduzindo 0/${totalElements} elementos...`;
                
                // Processar em lotes para não sobrecarregar
                const batchSize = 3; // Reduzido para evitar limite da API
                for (let i = 0; i < detectedTextElements.length; i += batchSize) {
                    const batch = detectedTextElements.slice(i, i + batchSize);
                    
                    const promises = batch.map(async (elementData) => {
                        try {
                            const translation = await this.translateText(elementData.text, sourceLang, targetLang);
                            
                            // Armazenar tradução para uso no PowerPoint
                            currentTranslation.translations[elementData.text] = translation;
                            
                            // Aplicar tradução
                            if (elementData.property) {
                                elementData.element[elementData.property] = translation;
                            } else {
                                elementData.element.textContent = translation;
                            }
                            
                            translatedElements++;
                            
                            return translation;
                        } catch (error) {
                            console.error('Erro ao traduzir elemento:', error);
                            return elementData.text; // Mantém o texto original em caso de erro
                        }
                    });
                    
                    await Promise.all(promises);
                    
                    // Atualizar status
                    document.getElementById('translationStatus').textContent = 
                        `Traduzindo ${Math.min(i + batchSize, totalElements)}/${totalElements} elementos...`;
                    
                    // Delay maior para evitar limite da API
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
                
                UIController.hideLoading();
                
                // Limpar destaques
                document.querySelectorAll('.highlighted-element').forEach(el => {
                    el.classList.remove('highlighted-element');
                    const badge = el.querySelector('.text-badge');
                    if (badge) badge.remove();
                });
                
                // Salvar após traduzir
                dataManager.save();
                
                // Atualizar status final
                document.getElementById('translationStatus').textContent = 
                    `Tradução concluída! ${translatedElements} elementos traduzidos.`;
                
                UIController.showNotification(`Tradução concluída! ${translatedElements} elementos traduzidos.`, 'success');
            },
            
            // Função para formatar datas de acordo com o idioma
            formatDateForLanguage: function(dateString, targetLang) {
                if (!dateString) return '';
                
                const date = new Date(dateString);
                
                if (targetLang === 'en') {
                    // Formato MM/DD/YYYY para inglês
                    const month = String(date.getMonth() + 1).padStart(2, '0');
                    const day = String(date.getDate()).padStart(2, '0');
                    const year = date.getFullYear();
                    return `${month}/${day}/${year}`;
                } else {
                    // Formato DD/MM/YYYY para português e outros
                    const day = String(date.getDate()).padStart(2, '0');
                    const month = String(date.getMonth() + 1).padStart(2, '0');
                    const year = date.getFullYear();
                    return `${day}/${month}/${year}`;
                }
            }
        };

        // ==================== CLASSES ====================
        class DataManager {
            constructor() {
                this.storageKey = 'inspectionFormData';
            }

            save() {
                const formData = this.collectFormData();
                localStorage.setItem(this.storageKey, JSON.stringify(formData));
                lastSaveTime = new Date();
                this.showBackupNotification();
            }

            load() {
                const savedData = localStorage.getItem(this.storageKey);
                if (savedData) {
                    try {
                        const formData = JSON.parse(savedData);
                        this.restoreFormData(formData);
                        console.log('Dados restaurados do backup');
                        return true;
                    } catch (error) {
                        console.error('Erro ao restaurar dados do backup:', error);
                    }
                }
                return false;
            }

            collectFormData() {
                const photos = [];
                const photoItems = document.querySelectorAll('.photo-grid-item');
                
                photoItems.forEach((item) => {
                    const description = item.querySelector('.photo-description textarea').value;
                    const img = item.querySelector('img');
                    const photoInfo = item.querySelector('.photo-info');
                    
                    // Coletar informações da foto
                    let pn = '';
                    let partName = '';
                    let quantity = '';
                    
                    if (photoInfo) {
                        pn = photoInfo.querySelector('[data-field="pn"]')?.value || '';
                        partName = photoInfo.querySelector('[data-field="partName"]')?.value || '';
                        quantity = photoInfo.querySelector('[data-field="quantity"]')?.value || '';
                    }
                    
                    photos.push({
                        description: description,
                        pn: pn,
                        partName: partName,
                        quantity: quantity,
                        hasImage: img && img.src && img.src !== window.location.href && img.style.display !== 'none',
                        imageData: img && img.style.display !== 'none' ? img.src : null,
                        editedImageData: img && img.getAttribute('data-edited-image') ? img.getAttribute('data-edited-image') : null
                    });
                });

                return {
                    modelo: document.getElementById('modelo')?.value || '',
                    sn: document.getElementById('sn')?.value || '',
                    tag: document.getElementById('tag')?.value || '',
                    entrega: document.getElementById('entrega')?.value || '',
                    cliente: document.getElementById('cliente')?.value || '',
                    descricao: document.getElementById('descricao')?.value || '',
                    machineDown: document.getElementById('machineDown')?.value || '',
                    data: document.getElementById('date')?.value || '',
                    inspetor: document.getElementById('inspector')?.value || '',
                    horimetro: document.getElementById('hourmeter')?.value || '',
                    photoCount: photoCount,
                    photos: photos,
                    conclusion: document.getElementById('conclusion')?.value || '',
                    // Armazenar informações de tradução
                    translation: currentTranslation
                };
            }

            restoreFormData(formData) {
                // Restaurar campos do formulário
                const fields = ['modelo', 'sn', 'tag', 'entrega', 'cliente', 'descricao', 'machineDown', 
                            'data', 'inspetor', 'horimetro'];
                
                fields.forEach(field => {
                    const element = document.getElementById(field);
                    if (element && formData[field]) {
                        element.value = formData[field];
                    }
                });
                
                // Restaurar campo de conclusão
                const conclusionField = document.getElementById('conclusion');
                if (conclusionField && formData.conclusion) {
                    conclusionField.value = formData.conclusion;
                }
                
                // Restaurar número de fotos
                if (formData.photoCount) {
                    photoCount = formData.photoCount;
                    PhotoManager.createPhotoGrid(photoCount);
                    
                    // Restaurar dados das fotos
                    if (formData.photos && formData.photos.length > 0) {
                        const photoItems = document.querySelectorAll('.photo-grid-item');
                        formData.photos.forEach((photoData, index) => {
                            if (index < photoItems.length) {
                                const descTextarea = photoItems[index].querySelector('.photo-description textarea');
                                const img = photoItems[index].querySelector('img');
                                
                                if (descTextarea && photoData.description) descTextarea.value = photoData.description;
                                if (img && photoData.imageData) {
                                    img.src = photoData.imageData;
                                    img.style.display = 'block';
                                    
                                    // Se houver imagem editada, usar essa
                                    if (photoData.editedImageData) {
                                        img.setAttribute('data-edited-image', photoData.editedImageData);
                                        img.src = photoData.editedImageData;
                                    }
                                    
                                    const icon = photoItems[index].querySelector('i');
                                    const text = photoItems[index].querySelector('p');
                                    if (icon) icon.style.display = 'none';
                                    if (text) text.style.display = 'none';
                                }
                                
                                // Restaurar informações da foto
                                if (photoData.pn || photoData.partName || photoData.quantity) {
                                    PhotoManager.updatePhotoInfo(index, photoData.pn, photoData.partName, photoData.quantity);
                                }
                            }
                        });
                    }
                }
                
                // Restaurar informações de tradução se existirem
                if (formData.translation) {
                    currentTranslation = formData.translation;
                }
                
                // Atualizar tabela Numero da Peça após restaurar
                PhotoManager.updatePNTable();
            }

            showBackupNotification() {
                const backupStatus = document.getElementById('backupStatus');
                backupStatus.classList.add('show');
                
                setTimeout(() => {
                    backupStatus.classList.remove('show');
                }, 2000);
            }

            clear() {
                localStorage.removeItem(this.storageKey);
            }
        }

        class ImageManager {
            static async fetchImageAsBase64(url) {
                try {
                    return await this.tryFetchImage(url);
                } catch (error) {
                    console.warn('Falha ao carregar imagem original, tentando alternativas...');
                }
                
                for (const altUrl of CONFIG.FALLBACK_IMAGES) {
                    try {
                        console.log('Tentando URL alternativa:', altUrl);
                        return await this.tryFetchImage(altUrl);
                    } catch (error) {
                        console.warn('Falha ao carregar URL alternativa:', altUrl);
                    }
                }
                
                console.warn('Todas as URLs falharam, usando imagem de fallback');
                return this.createFallbackImage();
            }

            static tryFetchImage(url) {
                return new Promise((resolve, reject) => {
                    const proxyUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(url);
                    
                    fetch(proxyUrl)
                        .then(response => {
                            if (!response.ok) {
                                throw new Error('Falha ao carregar imagem via proxy');
                            }
                            return response.blob();
                        })
                        .then(blob => {
                            const reader = new FileReader();
                            reader.onloadend = () => resolve(reader.result);
                            reader.readAsDataURL(blob);
                        })
                        .catch(error => {
                            this.tryDirectImage(url)
                                .then(resolve)
                                .catch(reject);
                        });
                });
            }

            static tryDirectImage(url) {
                return new Promise((resolve, reject) => {
                    const img = new Image();
                    img.crossOrigin = 'Anonymous';
                    
                    img.onload = function() {
                        const canvas = document.createElement('canvas');
                        canvas.width = img.width;
                        canvas.height = img.height;
                        
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0);
                        
                        try {
                            const dataURL = canvas.toDataURL('image/jpeg', 0.8);
                            resolve(dataURL);
                        } catch (e) {
                            reject(new Error('Não foi possível converter a imagem para base64'));
                        }
                    };
                    
                    img.onerror = function() {
                        reject(new Error('Não foi possível carregar a imagem diretamente'));
                    };
                    
                    img.src = url;
                });
            }

            static createFallbackImage() {
                return new Promise((resolve) => {
                    const canvas = document.createElement('canvas');
                    canvas.width = 1920;
                    canvas.height = 1080;
                    
                    const ctx = canvas.getContext('2d');
                    
                    // Criar gradiente industrial
                    const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                    gradient.addColorStop(0, '#2c3e50');
                    gradient.addColorStop(0.5, '#34495e');
                    gradient.addColorStop(1, '#2c3e50');
                    
                    ctx.fillStyle = gradient;
                    ctx.fillRect(0, 0, canvas.width, canvas.height);
                    
                    // Adicionar textura
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.02)';
                    for (let i = 0; i < 100; i++) {
                        const x = Math.random() * canvas.width;
                        const y = Math.random() * canvas.height;
                        const width = Math.random() * 200 + 50;
                        const height = Math.random() * 200 + 50;
                        
                        ctx.fillRect(x, y, width, height);
                    }
                    
                    // Adicionar texto
                    ctx.fillStyle = 'rgba(255, 165, 0, 0.3)';
                    ctx.font = 'bold 120px Arial';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText('ZAMINE', canvas.width / 2, canvas.height / 2);
                    
                    ctx.font = '60px Arial';
                    ctx.fillText('EXCAVADORA', canvas.width / 2, canvas.height / 2 + 100);
                    
                    resolve(canvas.toDataURL('image/jpeg', 0.8));
                });
            }

            static async preloadBackgroundImage() {
                try {
                    cachedBackgroundImage = await this.fetchImageAsBase64(CONFIG.BACKGROUND_IMAGE_URL);
                    console.log('Imagem de fundo carregada com sucesso');
                } catch (error) {
                    console.error('Erro ao pré-carregar imagem de fundo:', error);
                }
            }

            static async getClipboardImage() {
                try {
                    const clipboardItems = await navigator.clipboard.read();
                    for (const clipboardItem of clipboardItems) {
                        for (const type of clipboardItem.types) {
                            if (type.startsWith('image/')) {
                                const blob = await clipboardItem.getType(type);
                                return new Promise((resolve) => {
                                    const reader = new FileReader();
                                    reader.onloadend = () => resolve(reader.result);
                                    reader.readAsDataURL(blob);
                                });
                            }
                        }
                    }
                    return null;
                } catch (error) {
                    console.error('Erro ao acessar área de transferência:', error);
                    return null;
                }
            }
        }

        class PhotoManager {
            static createPhotoGrid(count) {
                const photoGrid = document.getElementById('photoGrid');
                
                // Coletar fotos existentes antes de limpar
                const existingPhotos = [];
                const photoItems = photoGrid.querySelectorAll('.photo-grid-item');
                
                photoItems.forEach((item) => {
                    const description = item.querySelector('.photo-description textarea').value;
                    const img = item.querySelector('img');
                    const photoInfo = item.querySelector('.photo-info');
                    
                    let pn = '';
                    let partName = '';
                    let quantity = '';
                    
                    if (photoInfo) {
                        pn = photoInfo.querySelector('[data-field="pn"]')?.value || '';
                        partName = photoInfo.querySelector('[data-field="partName"]')?.value || '';
                        quantity = photoInfo.querySelector('[data-field="quantity"]')?.value || '';
                    }
                    
                    const hasImage = img && img.src && img.src !== window.location.href && img.style.display !== 'none';
                    
                    existingPhotos.push({
                        description: description,
                        pn: pn,
                        partName: partName,
                        quantity: quantity,
                        hasImage: hasImage,
                        imageData: hasImage ? img.src : null,
                        editedImageData: img && img.getAttribute('data-edited-image') ? img.getAttribute('data-edited-image') : null
                    });
                });
                
                // Limpar grid atual
                photoGrid.innerHTML = '';
                
                // Criar novos itens de foto
                for (let i = 0; i < count; i++) {
                    const photoItem = document.createElement('div');
                    photoItem.className = 'photo-grid-item';
                    
                    // Usar dados existentes se disponível
                    const existingPhoto = existingPhotos[i] || {};
                    
                    photoItem.innerHTML = `
                        <div class="photo-actions">
                            <button class="photo-action-btn photo-edit-btn" onclick="openPhotoEditor(${i})" title="Editar Foto">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="photo-action-btn photo-delete-btn" onclick="deletePhoto(${i})" title="Excluir Foto">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        <div class="photo-info">
                            <div class="photo-info-item">
                                <div class="photo-info-label required">Numero da Peça:</div>
                                <input type="text" class="photo-info-value" data-field="pn" placeholder="Obrigatório" value="${existingPhoto.pn || ''}" onchange="updatePNTable()">
                            </div>
                            <div class="photo-info-item">
                                <div class="photo-info-label">Peça:</div>
                                <input type="text" class="photo-info-value" data-field="partName" placeholder="Nome da peça" value="${existingPhoto.partName || ''}" onchange="updatePNTable()">
                            </div>
                            <div class="photo-info-item">
                                <div class="photo-info-label">Qtd:</div>
                                <input type="number" class="photo-info-value" data-field="quantity" placeholder="Quantidade" value="${existingPhoto.quantity || ''}" min="1" onchange="updatePNTable()">
                            </div>
                        </div>
                        <div class="photo-area" onclick="showPhotoOptions(${i})">
                            <i class="fas fa-camera" style="${existingPhoto.hasImage ? 'display: none;' : ''}"></i>
                            <p style="${existingPhoto.hasImage ? 'display: none;' : ''}">Adicionar foto</p>
                            <img style="${existingPhoto.hasImage ? 'display: block;' : 'display: none;'}" 
                                src="${existingPhoto.editedImageData || existingPhoto.imageData || ''}"
                                data-edited-image="${existingPhoto.editedImageData || ''}">
                        </div>
                        <div class="photo-description">
                            <div style="position: relative;">
                                <textarea class="form-control" rows="2" placeholder="Adicione uma descrição detalhada da foto...">${existingPhoto.description || ''}</textarea>
                            </div>
                        </div>
                    `;
                    
                    photoGrid.appendChild(photoItem);
                }
                
                // Atualizar tabela Numero da Peça
                this.updatePNTable();
            }

            static updatePhotoInfo(index, pn, partName, quantity) {
                const photoItems = document.querySelectorAll('.photo-grid-item');
                if (photoItems[index]) {
                    const photoInfo = photoItems[index].querySelector('.photo-info');
                    if (photoInfo) {
                        const pnInput = photoInfo.querySelector('[data-field="pn"]');
                        const partNameInput = photoInfo.querySelector('[data-field="partName"]');
                        const quantityInput = photoInfo.querySelector('[data-field="quantity"]');
                        
                        if (pnInput) pnInput.value = pn;
                        if (partNameInput) partNameInput.value = partName;
                        if (quantityInput) quantityInput.value = quantity;
                    }
                }
            }

            static updatePNTable() {
                const photoItems = document.querySelectorAll('.photo-grid-item');
                const pnTableBody = document.getElementById('pnTableBody');
                
                // Limpar tabela atual
                pnTableBody.innerHTML = '';
                
                // Coletar todos os PNs
                const pnData = [];
                photoItems.forEach((item, index) => {
                    const pn = item.querySelector('[data-field="pn"]')?.value;
                    const partName = item.querySelector('[data-field="partName"]')?.value;
                    const quantity = item.querySelector('[data-field="quantity"]')?.value;
                    const hasImage = item.querySelector('img')?.style.display !== 'none';
                    
                    if (pn && pn.trim() !== '') {
                        pnData.push({
                            pn: pn,
                            partName: partName || '-',
                            quantity: quantity || '-',
                            photoIndex: index + 1,
                            hasImage: hasImage
                        });
                    }
                });
                
                // Adicionar linhas à tabela
                pnData.forEach(data => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td><strong>${data.pn}</strong></td>
                        <td>${data.partName}</td>
                        <td>${data.quantity}</td>
                        <td>${data.hasImage ? 'Foto ' + data.photoIndex : 'Sem foto'}</td>
                    `;
                    pnTableBody.appendChild(row);
                });
            }

            static addMultiplePhotos() {
                const input = document.createElement('input');
                input.type = 'file';
                input.multiple = true;
                input.accept = 'image/*';
                
                input.addEventListener('change', function(e) {
                    const files = Array.from(e.target.files);
                    const photoAreas = document.querySelectorAll('.photo-area');
                    
                    files.forEach((file, index) => {
                        if (index < photoAreas.length) {
                            const reader = new FileReader();
                            reader.onload = function(event) {
                                const photoArea = photoAreas[index];
                                const img = photoArea.querySelector('img');
                                const icon = photoArea.querySelector('i');
                                const text = photoArea.querySelector('p');
                                
                                img.src = event.target.result;
                                img.style.display = 'block';
                                img.setAttribute('data-edited-image', '');
                                
                                if (icon) icon.style.display = 'none';
                                if (text) text.style.display = 'none';
                            };
                            reader.readAsDataURL(file);
                        }
                    });
                    
                    // Salvar após adicionar fotos
                    dataManager.save();
                    this.updatePNTable();
                });
                
                input.click();
            }

            static openCamera(index) {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.capture = 'camera';
                
                input.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            const photoItems = document.querySelectorAll('.photo-grid-item');
                            if (photoItems[index]) {
                                const photoArea = photoItems[index].querySelector('.photo-area');
                                const img = photoArea.querySelector('img');
                                const icon = photoArea.querySelector('i');
                                const text = photoArea.querySelector('p');
                                
                                img.src = event.target.result;
                                img.style.display = 'block';
                                img.setAttribute('data-edited-image', '');
                                
                                if (icon) icon.style.display = 'none';
                                if (text) text.style.display = 'none';
                                
                                // Salvar após adicionar foto
                                dataManager.save();
                            }
                        };
                        reader.readAsDataURL(file);
                    }
                });
                
                input.click();
            }

            static async pasteFromClipboard(index) {
                try {
                    const imageData = await ImageManager.getClipboardImage();
                    
                    if (imageData) {
                        const photoItems = document.querySelectorAll('.photo-grid-item');
                        if (photoItems[index]) {
                            const photoArea = photoItems[index].querySelector('.photo-area');
                            const img = photoArea.querySelector('img');
                            const icon = photoArea.querySelector('i');
                            const text = photoArea.querySelector('p');
                            
                            img.src = imageData;
                            img.style.display = 'block';
                            img.setAttribute('data-edited-image', '');
                            
                            if (icon) icon.style.display = 'none';
                            if (text) text.style.display = 'none';
                            
                            // Salvar após adicionar foto
                            dataManager.save();
                        }
                    } else {
                        alert('Nenhuma imagem encontrada na área de transferência. Faça um print e tente novamente (Ctrl+V).');
                    }
                } catch (error) {
                    console.error('Erro ao colar imagem:', error);
                    alert('Não foi possível acessar a área de transferência. Verifique as permissões do navegador.');
                }
            }

            static openFileSelector(index) {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                
                input.addEventListener('change', function(e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            const photoItems = document.querySelectorAll('.photo-grid-item');
                            if (photoItems[index]) {
                                const photoArea = photoItems[index].querySelector('.photo-area');
                                const img = photoArea.querySelector('img');
                                const icon = photoArea.querySelector('i');
                                const text = photoArea.querySelector('p');
                                
                                img.src = event.target.result;
                                img.style.display = 'block';
                                img.setAttribute('data-edited-image', '');
                                
                                if (icon) icon.style.display = 'none';
                                if (text) text.style.display = 'none';
                                
                                // Salvar após adicionar foto
                                dataManager.save();
                            }
                        };
                        reader.readAsDataURL(file);
                    }
                });
                
                input.click();
            }

            static deletePhoto(index) {
                if (confirm('Tem certeza que deseja excluir esta foto?')) {
                    const photoItems = document.querySelectorAll('.photo-grid-item');
                    if (photoItems[index]) {
                        const photoItem = photoItems[index];
                        const img = photoItem.querySelector('img');
                        const icon = photoItem.querySelector('i');
                        const text = photoItem.querySelector('p');
                        
                        // Limpar imagem
                        img.src = '';
                        img.style.display = 'none';
                        img.setAttribute('data-edited-image', '');
                        
                        // Mostrar ícone e texto novamente
                        if (icon) icon.style.display = 'block';
                        if (text) text.style.display = 'block';
                        
                        // Salvar após excluir foto
                        dataManager.save();
                        this.updatePNTable();
                    }
                }
            }
        }

        class PhotoEditor {
            constructor() {
                this.canvas = null;
                this.currentMode = 'select';
                this.isDrawing = false;
                this.startX = 0;
                this.startY = 0;
                this.currentObject = null;
                this.backgroundImage = null; // Armazenar referência à imagem de fundo
            }

            initialize(imageSrc) {
                const canvasElement = document.getElementById('photoEditorCanvas');
                this.canvas = new fabric.Canvas('photoEditorCanvas');
                
                // Carregar imagem no canvas
                fabric.Image.fromURL(imageSrc, (img) => {
                    // Redimensionar canvas para acomodar a imagem
                    const canvasContainer = document.querySelector('.editor-canvas-container');
                    const containerWidth = canvasContainer.clientWidth;
                    const containerHeight = canvasContainer.clientHeight;
                    
                    // Calcular escala para ajustar a imagem ao container
                    const scale = Math.min(
                        containerWidth / img.width,
                        containerHeight / img.height
                    );
                    
                    // Aplicar escala e centralizar
                    img.scale(scale);
                    this.canvas.setWidth(img.width * scale);
                    this.canvas.setHeight(img.height * scale);
                    
                    // Configurar a imagem como fundo (não selecionável)
                    img.set({
                        selectable: false,
                        evented: false, // Não responde a eventos
                        lockMovementX: true,
                        lockMovementY: true,
                        lockScalingX: true,
                        lockScalingY: true,
                        lockRotation: true,
                        hasControls: false,
                        hasBorders: false
                    });
                    
                    // Adicionar imagem ao canvas
                    this.canvas.add(img);
                    
                    // Enviar imagem para o fundo
                    this.canvas.sendToBack(img);
                    
                    // Armazenar referência à imagem de fundo
                    this.backgroundImage = img;
                    
                    this.canvas.renderAll();
                });
                
                // Configurar eventos
                this.setupEventListeners();
            }

            setupEventListeners() {
                // Eventos de mouse
                this.canvas.on('mouse:down', (e) => {
                    // Verificar se clicou na imagem de fundo
                    if (e.target && e.target === this.backgroundImage) {
                        return; // Não fazer nada se clicou na imagem de fundo
                    }
                    
                    if (this.currentMode === 'select') return;
                    
                    this.isDrawing = true;
                    const pointer = this.canvas.getPointer(e.e);
                    this.startX = pointer.x;
                    this.startY = pointer.y;
                    
                    if (this.currentMode === 'pen') {
                        this.currentObject = new fabric.Path([], {
                            stroke: document.getElementById('colorPicker').value,
                            strokeWidth: 3,
                            fill: '',
                            selectable: true,
                            evented: true
                        });
                        this.canvas.add(this.currentObject);
                    } else if (this.currentMode === 'text') {
                        const text = new fabric.IText('Texto', {
                            left: pointer.x,
                            top: pointer.y,
                            fontFamily: 'Arial',
                            fontSize: 20,
                            fill: document.getElementById('colorPicker').value,
                            selectable: true,
                            evented: true
                        });
                        this.canvas.add(text);
                        this.canvas.setActiveObject(text);
                        text.enterEditing();
                        this.isDrawing = false;
                    }
                });
                
                this.canvas.on('mouse:move', (e) => {
                    if (!this.isDrawing || this.currentMode === 'select' || this.currentMode === 'text') return;
                    
                    const pointer = this.canvas.getPointer(e.e);
                    
                    if (this.currentMode === 'pen') {
                        const path = this.currentObject.path;
                        path.push(['L', pointer.x, pointer.y]);
                        this.currentObject.dirty = true;
                        this.canvas.renderAll();
                    } else if (this.currentMode === 'circle') {
                        const radius = Math.sqrt(
                            Math.pow(pointer.x - this.startX, 2) + 
                            Math.pow(pointer.y - this.startY, 2)
                        );
                        
                        if (this.currentObject) {
                            this.canvas.remove(this.currentObject);
                        }
                        
                        this.currentObject = new fabric.Circle({
                            left: this.startX - radius,
                            top: this.startY - radius,
                            radius: radius,
                            fill: '',
                            stroke: document.getElementById('colorPicker').value,
                            strokeWidth: 3,
                            selectable: true,
                            evented: true
                        });
                        this.canvas.add(this.currentObject);
                    } else if (this.currentMode === 'rectangle') {
                        const width = pointer.x - this.startX;
                        const height = pointer.y - this.startY;
                        
                        if (this.currentObject) {
                            this.canvas.remove(this.currentObject);
                        }
                        
                        this.currentObject = new fabric.Rect({
                            left: this.startX,
                            top: this.startY,
                            width: width,
                            height: height,
                            fill: '',
                            stroke: document.getElementById('colorPicker').value,
                            strokeWidth: 3,
                            selectable: true,
                            evented: true
                        });
                        this.canvas.add(this.currentObject);
                    } else if (this.currentMode === 'arrow') {
                        const headLength = 15;
                        const angle = Math.atan2(pointer.y - this.startY, pointer.x - this.startX);
                        
                        if (this.currentObject) {
                            this.canvas.remove(this.currentObject);
                        }
                        
                        // Linha principal
                        const line = new fabric.Line([this.startX, this.startY, pointer.x, pointer.y], {
                            stroke: document.getElementById('colorPicker').value,
                            strokeWidth: 3,
                            selectable: false,
                            evented: false
                        });
                        
                        // Cabeça da seta (triângulo)
                        const points = [
                            { x: pointer.x, y: pointer.y },
                            { x: pointer.x - headLength * Math.cos(angle - Math.PI / 6), y: pointer.y - headLength * Math.sin(angle - Math.PI / 6) },
                            { x: pointer.x - headLength * Math.cos(angle + Math.PI / 6), y: pointer.y - headLength * Math.sin(angle + Math.PI / 6) }
                        ];
                        
                        const triangle = new fabric.Polygon(points, {
                            fill: document.getElementById('colorPicker').value,
                            selectable: false,
                            evented: false
                        });
                        
                        // Grupo com linha e triângulo
                        this.currentObject = new fabric.Group([line, triangle], {
                            selectable: true,
                            evented: true
                        });
                        
                        this.canvas.add(this.currentObject);
                    }
                });
                
                this.canvas.on('mouse:up', () => {
                    if (this.currentObject && this.currentMode !== 'select') {
                        this.currentObject.set({
                            selectable: true,
                            evented: true
                        });
                    }
                    this.isDrawing = false;
                    this.currentObject = null;
                });
            }

            setMode(mode) {
                this.currentMode = mode;
                
                // Atualizar botões ativos
                document.querySelectorAll('.editor-tool-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                
                if (mode === 'select') {
                    document.querySelector('.editor-tool-btn[title="Selecionar"]').classList.add('active');
                    this.canvas.isDrawingMode = false;
                    this.canvas.selection = true;
                } else if (mode === 'pen') {
                    document.querySelector('.editor-tool-btn[title="Caneta"]').classList.add('active');
                    this.canvas.isDrawingMode = false;
                    this.canvas.selection = false;
                } else if (mode === 'circle') {
                    document.querySelector('.editor-tool-btn[title="Círculo"]').classList.add('active');
                    this.canvas.isDrawingMode = false;
                    this.canvas.selection = false;
                } else if (mode === 'rectangle') {
                    document.querySelector('.editor-tool-btn[title="Retângulo"]').classList.add('active');
                    this.canvas.isDrawingMode = false;
                    this.canvas.selection = false;
                } else if (mode === 'arrow') {
                    document.querySelector('.editor-tool-btn[title="Seta"]').classList.add('active');
                    this.canvas.isDrawingMode = false;
                    this.canvas.selection = false;
                } else if (mode === 'text') {
                    document.querySelector('.editor-tool-btn[title="Texto"]').classList.add('active');
                    this.canvas.isDrawingMode = false;
                    this.canvas.selection = false;
                }
            }

            deleteSelected() {
                const activeObjects = this.canvas.getActiveObjects();
                if (activeObjects.length > 0) {
                    activeObjects.forEach(obj => {
                        // Não permitir excluir a imagem de fundo
                        if (obj !== this.backgroundImage) {
                            this.canvas.remove(obj);
                        }
                    });
                    this.canvas.discardActiveObject();
                    this.canvas.renderAll();
                }
            }

            clear() {
                if (confirm('Tem certeza que deseja limpar todas as edições?')) {
                    // Remover todos os objetos exceto a imagem de fundo
                    const objects = this.canvas.getObjects();
                    objects.forEach(obj => {
                        if (obj !== this.backgroundImage) {
                            this.canvas.remove(obj);
                        }
                    });
                    
                    this.canvas.renderAll();
                }
            }

            getEditedImage() {
                return this.canvas.toDataURL({
                    format: 'jpeg',
                    quality: 0.9
                });
            }

            dispose() {
                if (this.canvas) {
                    this.canvas.dispose();
                    this.canvas = null;
                }
            }
        }

        // ==================== GERADOR DE POWERPOINT ====================
       // ==================== GERADOR DE POWERPOINT ====================
// ==================== GERADOR DE POWERPOINT ====================
class PowerPointGenerator {
    // ALTERADO: Adicionado um placeholder para a logo para evitar erros.
    // SUBSTITUA ESTE VALOR PELO CÓDIGO BASE64 DA SUA LOGO.
    // Exemplo: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=='
    static PLACEHOLDER_LOGO = 'data:image/png;base64,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';

    static async generatePowerPoint() {
        const spinner = document.getElementById('loadingSpinner');
        const errorText = document.getElementById('errorText');
        const successText = document.getElementById('successText');
        let loadingText = spinner.querySelector('.loading-text');
        
        try {
            spinner.classList.add('active');
            errorText.style.display = 'none';
            successText.style.display = 'none';
            
            loadingText.textContent = 'Verificando imagem de fundo...';
            
            // Coletar dados do formulário
            const inspectionData = this.collectInspectionData();
            const photos = this.collectPhotos();
            const conclusion = this.collectConclusion();
            
            // Verificar se há tradução ativa
            const isTranslated = currentTranslation && currentTranslation.targetLang !== 'pt';
            
            // Criar nova apresentação PowerPoint
            const pptx = new PptxGenJS();
            
            // Gerar slides
            this.generateSlide1(pptx, inspectionData, isTranslated);
            this.generatePhotoSlides(pptx, photos, isTranslated);
            this.generatePNTableSlide(pptx, photos, isTranslated);
            this.generateConclusionSlide(pptx, conclusion, isTranslated);
            this.generateFinalSlide(pptx, isTranslated);
            
            // Baixar o arquivo
            loadingText.textContent = 'Salvando arquivo...';
            const fileName = `Inspecao_ZServices_AI_${this.formatDateForFileName(inspectionData.data)}.pptx`;
            await pptx.writeFile({ fileName: fileName });
            
            // Sucesso
            loadingText.textContent = 'PowerPoint gerado com sucesso!';
            successText.textContent = 'Arquivo salvo com sucesso';
            successText.style.display = 'block';
            
            setTimeout(() => {
                spinner.classList.remove('active');
                this.showNotification('PowerPoint baixado com sucesso!');
            }, 2000);
            
        } catch (error) {
            console.error('Erro ao gerar PowerPoint:', error);
            errorText.textContent = `Erro: ${error.message}`;
            errorText.style.display = 'block';
            loadingText.textContent = 'Erro ao gerar PowerPoint';
            
            setTimeout(() => {
                spinner.classList.remove('active');
            }, 3000);
        }
    }

    // Função auxiliar para adicionar cabeçalho padrão em todos os slides
    static addStandardHeader(pptx, slide, title, isTranslated) {
        // Adicionar logo
        slide.addImage({
            data: PowerPointGenerator.PLACEHOLDER_LOGO, // ALTERADO: Usando a constante do placeholder
            x: 0.3,
            y: 0.2,
            w: 1.5,
            h: 0.5,
            sizing: {type: 'contain'}
        });
        
        slide.addText(title, {
            x: 8.2,
            y: 0.2,
            w: 1.5,
            h: 0.5,
            fontSize: 10,
            bold: true,
            color: '000000',
            fontFace: 'Arial',
            align: 'right'
        });
        
        // Adicionar linha separadora
        slide.addShape(pptx.ShapeType.rect, {
            x: 0.3,
            y: 0.9,
            w: 9.4,
            h: 0.04,
            fill: { color: 'FF6600' }
        });
    }

    // Função auxiliar para adicionar rodapé padrão em todos os slides
    static addStandardFooter(slide) {
        slide.addText('© 2023 - Departamento de Manutenção Industrial | Todos os direitos reservados', {
            x: 0.3,
            y: 7,
            w: 9.4,
            h: 0.3,
            fontSize: 8,
            color: '000000',
            fontFace: 'Arial',
            align: 'center'
        });
    }

    static formatDateForFileName(dateString) {
        if (!dateString) return new Date().toISOString().split('T')[0];
        
        const date = new Date(dateString);
        const day = String(date.getDate()).padStart(2, '0');
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const year = date.getFullYear();
        return `${day}-${month}-${year}`;
    }

    static formatDateForDisplay(dateString, targetLang = 'pt') {
        if (!dateString) return '';
        
        // Usar a função do TranslationManager para formatar a data
        return TranslationManager.formatDateForLanguage(dateString, targetLang);
    }

    static collectInspectionData() {
        return {
            modelo: document.getElementById('modelo')?.value || '',
            sn: document.getElementById('sn')?.value || '',
            tag: document.getElementById('tag')?.value || '',
            entrega: document.getElementById('entrega')?.value || '',
            cliente: document.getElementById('cliente')?.value || '',
            descricao: document.getElementById('descricao')?.value || '',
            machineDown: document.getElementById('machineDown')?.value || '',
            data: document.getElementById('date')?.value || '',
            inspetor: document.getElementById('inspector')?.value || '',
            horimetro: document.getElementById('hourmeter')?.value || ''
        };
    }

    static collectPhotos() {
        const photos = [];
        const photoItems = document.querySelectorAll('.photo-grid-item');
        
        photoItems.forEach((item, index) => {
            const description = item.querySelector('.photo-description textarea').value || `Foto ${index + 1}`;
            const img = item.querySelector('img');
            const photoInfo = item.querySelector('.photo-info');
            
            let pn = '';
            let partName = '';
            let quantity = '';
            
            if (photoInfo) {
                pn = photoInfo.querySelector('[data-field="pn"]')?.value || '';
                partName = photoInfo.querySelector('[data-field="partName"]')?.value || '';
                quantity = photoInfo.querySelector('[data-field="quantity"]')?.value || '';
            }
            
            // Usar imagem editada se existir, caso contrário usar imagem original
            let imageData = null;
            if (img && img.getAttribute('data-edited-image')) {
                imageData = img.getAttribute('data-edited-image');
            } else if (img && img.src && img.src !== window.location.href && img.style.display !== 'none') {
                imageData = img.src;
            }
            
            photos.push({
                description: description,
                pn: pn,
                partName: partName,
                quantity: quantity,
                hasImage: img && img.src && img.src !== window.location.href && img.style.display !== 'none',
                imageData: imageData
            });
        });
        
        return photos;
    }

    static collectConclusion() {
        return document.getElementById('conclusion')?.value || '';
    }

    static generateSlide1(pptx, inspectionData, isTranslated) {
        const slide = pptx.addSlide();
        
        // Adicionar cabeçalho padrão
        this.addStandardHeader(pptx, slide, isTranslated ? 'INSPECTION' : 'INSPEÇÃO', isTranslated);
        
        // Adicionar título
        slide.addText(isTranslated ? 'Technical Report' : 'Relatório Técnico', {
            x: 0.3,
            y: 1.05,
            w: 6,
            h: 0.6,
            fontSize: 18,
            bold: true,
            color: '000000',
            fontFace: 'Arial'
        });
        
        // Adicionar card de informações
        const cardY = 1.85;
        
        // Fundo do card
        slide.addShape(pptx.ShapeType.roundRect, {
            x: 0.3,
            y: cardY,
            w: 9.4,
            h: 3.5,
            fill: { color: 'F8F9FA' },
            line: { color: 'E0E0E0', width: 1 }
        });
        
        // Borda lateral laranja
        slide.addShape(pptx.ShapeType.rect, {
            x: 0.3,
            y: cardY,
            w: 0.08,
            h: 3.5,
            fill: { color: 'FF6600' }
        });
        
        // Título do card
        slide.addText(isTranslated ? 'Inspection Information' : 'Informações da Inspeção', {
            x: 0.5,
            y: cardY + 0.08,
            w: 8,
            h: 0.35,
            fontSize: 12,
            bold: true,
            color: '000000',
            fontFace: 'Arial'
        });
        
        // Informações da máquina
        let infoY = cardY + 0.4;
        const machineInfo = [
            { label: isTranslated ? 'Model:' : 'Modelo:', value: inspectionData.modelo || '-' },
            { label: 'SN:', value: inspectionData.sn || '-' },
            { label: 'TAG:', value: inspectionData.tag || '-' },
            { label: isTranslated ? 'Delivery:' : 'Entrega:', value: inspectionData.entrega || '-' },
            { label: isTranslated ? 'Customer:' : 'Cliente:', value: inspectionData.cliente || '-' },
            { label: isTranslated ? 'Description:' : 'Descrição:', value: inspectionData.descricao || '-' },
            { label: 'MACHINE DOWN?:', value: inspectionData.machineDown || '-' }
        ];
        
        machineInfo.forEach(info => {
            slide.addText(info.label, {
                x: 0.5,
                y: infoY,
                w: 1.5,
                h: 0.22,
                fontSize: 9,
                bold: true,
                color: '000000',
                fontFace: 'Arial'
            });
            
            slide.addText(info.value, {
                x: 2,
                y: infoY,
                w: 7,
                h: 0.22,
                fontSize: 9,
                color: info.value === 'No' ? 'DC3545' : '000000',
                fontFace: 'Arial'
            });
            
            infoY += 0.22;
        });
        
        // Linha separadora
        slide.addShape(pptx.ShapeType.line, {
            x: 0.5,
            y: infoY + 0.03,
            w: 8.5,
            h: 0,
            line: { color: 'E0E0E0', width: 1, dashType: 'dash' }
        });
        
        // Dados do relatorio
        infoY += 0.12;
        slide.addText(isTranslated ? 'REPORT DATA' : 'DADOS DO RELATÓRIO', {
            x: 0.5,
            y: infoY,
            w: 8,
            h: 0.22,
            fontSize: 8,
            bold: true,
            color: 'FF6600',
            fontFace: 'Arial'
        });
        
        infoY += 0.22;
        const inspectionInfo = [
            { 
                label: isTranslated ? 'Inspection Date:' : 'Data da Inspeção:', 
                value: this.formatDateForDisplay(inspectionData.data, isTranslated ? 'en' : 'pt') || '-' 
            },
            { 
                label: isTranslated ? 'Inspector Name:' : 'Nome do Inspetor:', 
                value: inspectionData.inspetor || '-' 
            },
            { 
                label: isTranslated ? 'Hour Meter:' : 'Horímetro:', 
                value: inspectionData.horimetro || '-' 
            }
        ];
        
        inspectionInfo.forEach(info => {
            slide.addText(info.label, {
                x: 0.5,
                y: infoY,
                w: 1.5,
                h: 0.22,
                fontSize: 9,
                bold: true,
                color: '000000',
                fontFace: 'Arial'
            });
            
            slide.addText(info.value, {
                x: 2,
                y: infoY,
                w: 7,
                h: 0.22,
                fontSize: 9,
                color: '000000',
                fontFace: 'Arial'
            });
            
            infoY += 0.22;
        });
        
        // Adicionar rodapé padrão
        this.addStandardFooter(slide);
    }

    static generatePhotoSlides(pptx, photos, isTranslated) {
        // Calcular quantos slides de fotos são necessários (2 fotos por slide)
        const photoSlidesNeeded = Math.ceil(photos.length / 2);
        
        for (let slideIndex = 0; slideIndex < photoSlidesNeeded; slideIndex++) {
            const slide = pptx.addSlide();
            
            // Adicionar cabeçalho padrão
            this.addStandardHeader(pptx, slide, isTranslated ? 'PHOTOS' : 'FOTOS', isTranslated);
            
            // Fotos - ajustado para subir um pouco
            let photoY = 1.8;
            const photoWidth = 4.4;
            const photoHeight = 2.8;
            const photoGap = 0.3;
            
            // Foto 1 (índice: slideIndex * 2)
            const photo1Index = slideIndex * 2;
            if (photos[photo1Index]) {
                // Foto com espaçamento
                if (photos[photo1Index].hasImage && photos[photo1Index].imageData) {
                    slide.addImage({
                        data: photos[photo1Index].imageData,
                        x: 0.3,
                        y: photoY,
                        w: photoWidth,
                        h: photoHeight,
                        sizing: {type: 'cover'}
                    });
                } else {
                    // Placeholder sem borda
                    slide.addText(isTranslated ? '[No photo added]' : '[Nenhuma foto adicionada]', {
                        x: 0.3,
                        y: photoY + 1.2,
                        w: photoWidth,
                        h: 0.5,
                        fontSize: 14,
                        color: '#999999',
                        fontFace: 'Arial',
                        align: 'center',
                        valign: 'middle'
                    });
                }
                
                // Informações da foto
                if (photos[photo1Index].pn || photos[photo1Index].partName || photos[photo1Index].quantity) {
                    slide.addShape(pptx.ShapeType.rect, {
                        x: 0.3,
                        y: photoY - 0.5,
                        w: photoWidth,
                        h: 0.4,
                        fill: { color: '000000', transparency: 70 }
                    });
                    
                    let infoText = '';
                    if (photos[photo1Index].pn) infoText += `${isTranslated ? 'Part Number:' : 'Numero da Peça:'} ${photos[photo1Index].pn} `;
                    if (photos[photo1Index].partName) infoText += `${photos[photo1Index].partName} `;
                    if (photos[photo1Index].quantity) infoText += `${isTranslated ? 'Qty:' : 'Qtd:'} ${photos[photo1Index].quantity}`;
                    
                    slide.addText(infoText, {
                        x: 0.4,
                        y: photoY - 0.45,
                        w: photoWidth - 0.1,
                        h: 0.3,
                        fontSize: 10,
                        color: 'FFFFFF',
                        fontFace: 'Arial',
                        valign: 'top'
                    });
                }
                
                // Descrição - FUNDO LARANJA NO RODAPÉ DA IMAGEM
                if (photos[photo1Index].description) {
                    slide.addShape(pptx.ShapeType.rect, {
                        x: 0.3,
                        y: photoY + photoHeight,
                        w: photoWidth,
                        h: 0.5,
                        fill: { color: 'FF6600' }
                    });
                    
                    slide.addText(photos[photo1Index].description.substring(0, 120) + (photos[photo1Index].description.length > 120 ? '...' : ''), {
                        x: 0.4,
                        y: photoY + photoHeight + 0.05,
                        w: photoWidth - 0.1,
                        h: 0.4,
                        fontSize: 12,
                        color: '#FFFFFF',
                        fontFace: 'Arial',
                        valign: 'top'
                    });
                }
            }
            
            // Foto 2 (índice: slideIndex * 2 + 1)
            const photo2Index = slideIndex * 2 + 1;
            if (photos[photo2Index]) {
                // Foto com espaçamento
                if (photos[photo2Index].hasImage && photos[photo2Index].imageData) {
                    slide.addImage({
                        data: photos[photo2Index].imageData,
                        x: 0.3 + photoWidth + photoGap,
                        y: photoY,
                        w: photoWidth,
                        h: photoHeight,
                        sizing: {type: 'cover'}
                    });
                } else {
                    // Placeholder sem borda
                    slide.addText(isTranslated ? '[No photo added]' : '[Nenhuma foto adicionada]', {
                        x: 0.3 + photoWidth + photoGap,
                        y: photoY + 1.2,
                        w: photoWidth,
                        h: 0.5,
                        fontSize: 14,
                        color: '#999999',
                        fontFace: 'Arial',
                        align: 'center',
                        valign: 'middle'
                    });
                }
                
                // Informações da foto
                if (photos[photo2Index].pn || photos[photo2Index].partName || photos[photo2Index].quantity) {
                    slide.addShape(pptx.ShapeType.rect, {
                        x: 0.3 + photoWidth + photoGap,
                        y: photoY - 0.5,
                        w: photoWidth,
                        h: 0.4,
                        fill: { color: '000000', transparency: 70 }
                    });
                    
                    let infoText = '';
                    if (photos[photo2Index].pn) infoText += `${isTranslated ? 'Part Number:' : 'Numero da Peça:'} ${photos[photo2Index].pn} `;
                    if (photos[photo2Index].partName) infoText += `${photos[photo2Index].partName} `;
                    if (photos[photo2Index].quantity) infoText += `${isTranslated ? 'Qty:' : 'Qtd:'} ${photos[photo2Index].quantity}`;
                    
                    slide.addText(infoText, {
                        x: 0.4 + photoWidth + photoGap,
                        y: photoY - 0.45,
                        w: photoWidth - 0.1,
                        h: 0.3,
                        fontSize: 10,
                        color: 'FFFFFF',
                        fontFace: 'Arial',
                        valign: 'top'
                    });
                }
                
                // Descrição - FUNDO LARANJA NO RODAPÉ DA IMAGEM
                if (photos[photo2Index].description) {
                    slide.addShape(pptx.ShapeType.rect, {
                        x: 0.3 + photoWidth + photoGap,
                        y: photoY + photoHeight,
                        w: photoWidth,
                        h: 0.5,
                        fill: { color: 'FF6600' }
                    });
                    
                    slide.addText(photos[photo2Index].description.substring(0, 120) + (photos[photo2Index].description.length > 120 ? '...' : ''), {
                        x: 0.4 + photoWidth + photoGap,
                        y: photoY + photoHeight + 0.05,
                        w: photoWidth - 0.1,
                        h: 0.4,
                        fontSize: 12,
                        color: '#FFFFFF',
                        fontFace: 'Arial',
                        valign: 'top'
                    });
                }
            }
            
            // Adicionar rodapé padrão
            this.addStandardFooter(slide);
        }
    }

    static generatePNTableSlide(pptx, photos, isTranslated) {
        const slide = pptx.addSlide();
        
        // Adicionar cabeçalho padrão
        this.addStandardHeader(pptx, slide, isTranslated ? 'Parts Table (Part Number)' : 'Tabela de Peças (Numero da peça)', isTranslated);
        
        // Adicionar título
        slide.addText(isTranslated ? 'Technical Report' : 'Relatório Técnico', {
            x: 0.3,
            y: 1.05,
            w: 6,
            h: 0.5,
            fontSize: 18,
            bold: true,
            color: '000000',
            fontFace: 'Arial'
        });
        
        // Título da tabela
        slide.addText(isTranslated ? 'Parts Table (Part Number)' : 'Tabela de Peças (Numero da peça)', {
            x: 0.5,
            y: 1.6,
            w: 8,
            h: 0.3,
            fontSize: 14,
            bold: true,
            color: '000000',
            fontFace: 'Arial'
        });
        
        // Cabeçalho da tabela
        const headerY = 2.0;
        slide.addShape(pptx.ShapeType.rect, {
            x: 0.5,
            y: headerY,
            w: 8.8,
            h: 0.4,
            fill: { color: '000000' }
        });
        
        const headers = [
            { text: isTranslated ? 'Part Number' : 'Numero da peça', x: 0.5, w: 2 },
            { text: isTranslated ? 'Part Name' : 'Nome da Peça', x: 2.5, w: 3 },
            { text: isTranslated ? 'Quantity' : 'Quantidade', x: 5.5, w: 1.5 },
            { text: isTranslated ? 'Associated Photo' : 'Foto Associada', x: 7, w: 2.3 }
        ];
        
        headers.forEach(header => {
            slide.addText(header.text, {
                x: header.x,
                y: headerY + 0.05,
                w: header.w,
                h: 0.3,
                fontSize: 10,
                bold: true,
                color: 'FFFFFF',
                fontFace: 'Arial',
                align: 'center'
            });
        });
        
        // Linhas da tabela
        let rowY = headerY + 0.4;
        const rowHeight = 0.35;
        
        // Coletar PNs únicos
        const pnData = [];
        photos.forEach((photo, index) => {
            if (photo.pn && photo.pn.trim() !== '') {
                pnData.push({
                    pn: photo.pn,
                    partName: photo.partName || '-',
                    quantity: photo.quantity || '-',
                    photoIndex: index + 1,
                    hasImage: photo.hasImage
                });
            }
        });
        
        // Adicionar linhas da tabela
        pnData.forEach((data, index) => {
            // Linha separadora
            if (index > 0) {
                slide.addShape(pptx.ShapeType.line, {
                    x: 0.5,
                    y: rowY,
                    w: 8.8,
                    h: 0,
                    line: { color: 'E0E0E0', width: 1 }
                });
            }
            
            // Cor de fundo alternada
            if (index % 2 === 0) {
                slide.addShape(pptx.ShapeType.rect, {
                    x: 0.5,
                    y: rowY,
                    w: 8.8,
                    h: rowHeight,
                    fill: { color: 'F8F9FA' }
                });
            }
            
            // Dados da linha
            slide.addText(data.pn, {
                x: 0.5,
                y: rowY + 0.05,
                w: 2,
                h: rowHeight - 0.1,
                fontSize: 9,
                color: '000000',
                fontFace: 'Arial',
                align: 'center',
                valign: 'middle'
            });
            
            slide.addText(data.partName, {
                x: 2.5,
                y: rowY + 0.05,
                w: 3,
                h: rowHeight - 0.1,
                fontSize: 9,
                color: '000000',
                fontFace: 'Arial',
                align: 'center',
                valign: 'middle'
            });
            
            slide.addText(data.quantity, {
                x: 5.5,
                y: rowY + 0.05,
                w: 1.5,
                h: rowHeight - 0.1,
                fontSize: 9,
                color: '000000',
                fontFace: 'Arial',
                align: 'center',
                valign: 'middle'
            });
            
            slide.addText(data.hasImage ? (isTranslated ? 'Photo ' : 'Foto ') + data.photoIndex : (isTranslated ? 'No photo' : 'Sem foto'), {
                x: 7,
                y: rowY + 0.05,
                w: 2.3,
                h: rowHeight - 0.1,
                fontSize: 9,
                color: data.hasImage ? '000000' : '999999',
                fontFace: 'Arial',
                align: 'center',
                valign: 'middle'
            });
            
            rowY += rowHeight;
        });
        
        // Adicionar rodapé padrão
        this.addStandardFooter(slide);
    }

    static generateConclusionSlide(pptx, conclusion, isTranslated) {
        const slide = pptx.addSlide();
        
        // Adicionar cabeçalho padrão
        this.addStandardHeader(pptx, slide, isTranslated ? 'CONCLUSION' : 'CONCLUSÃO', isTranslated);
        
        // Adicionar título
        slide.addText(isTranslated ? 'Technical Report' : 'Relatório Técnico', {
            x: 0.3,
            y: 1.05,
            w: 6,
            h: 0.5,
            fontSize: 18,
            bold: true,
            color: '000000',
            fontFace: 'Arial'
        });
        
        // Título do card
        slide.addText(isTranslated ? 'CONCLUSION' : 'CONCLUSÃO', {
            x: 0.5,
            y: 1.6,
            w: 8,
            h: 0.3,
            fontSize: 14,
            bold: true,
            color: '000000',
            fontFace: 'Arial'
        });
        
        // Texto da conclusão
        slide.addText(conclusion || (isTranslated ? 'No conclusion provided.' : 'Nenhuma conclusão fornecida.'), {
            x: 0.5,
            y: 2.0,
            w: 8.8,
            h: 4,
            fontSize: 12,
            color: '000000',
            fontFace: 'Arial',
            valign: 'top'
        });
        
        // Adicionar rodapé padrão
        this.addStandardFooter(slide);
    }

      static generateFinalSlide(pptx, isTranslated) {
        const slide = pptx.addSlide();
        
        // Adicionar linha separadora (movida para cima)
        slide.addShape(pptx.ShapeType.rect, {
            x: 4.5,
            y: 0.8, // ALTERADO: Movido para cima
            w: 1,
            h: 0.08,
            fill: { color: 'FF6600' }
        });
        
        // Logo (movida para cima)
        slide.addImage({
            data: PowerPointGenerator.PLACEHOLDER_LOGO, // Usando a constante do placeholder
            x: 3.5,
            y: 1.1, // ALTERADO: Movido para cima
            w: 3,
            h: 1.7,
            sizing: {type: 'contain'}
        });
        
        // Citação de Segurança (movida para cima)
        slide.addText('"If it\'s not safe, don\'t do it!"', {
            x: 1,
            y: 3.0, // ALTERADO: Movido para cima
            w: 8,
            h: 0.8,
            fontSize: 28,
            bold: true,
            color: 'FF6600',
            fontFace: 'Aptos',
            align: 'center'
        });
        
        slide.addText('"There is nothing so important and urgent that it can\'t be done safely"', {
            x: 1,
            y: 4.0, // ALTERADO: Movido para cima
            w: 8,
            h: 0.6,
            fontSize: 22,
            bold: true,
            color: 'FF6600',
            fontFace: 'Aptos',
            align: 'center'
        });
        
        // Texto "END" (movido para cima)
        slide.addText('END', {
            x: 4,
            y: 5.0, // ALTERADO: Movido para cima
            w: 2,
            h: 0.8,
            fontSize: 28,
            bold: true,
            color: 'FF6600',
            fontFace: 'Aptos',
            align: 'center'
        });
        
        // Rodapé (mantido na posição original)
        slide.addText('© 2026 - Departamento de Serviços | Todos os direitos reservados', {
            x: 0.3,
            y: 7,
            w: 9.4,
            h: 0.3,
            fontSize: 8,
            color: '#666666',
            fontFace: 'Arial',
            align: 'center'
        });
    }
    
    static showNotification(message) {
        const notification = document.createElement('div');
        notification.className = 'alert alert-success position-fixed top-0 start-50 translate-middle-x mt-3';
        notification.style.zIndex = '9999';
        notification.style.minWidth = '300px';
        notification.textContent = message;

        document.body.appendChild(notification);

        setTimeout(() => {
            notification.remove();
        }, 5000);
    }
}

// ==================== INSTÂNCIAS GLOBAIS ====================
        const dataManager = new DataManager();

        // ==================== FUNÇÕES DE INTERFACE ====================
        function updateMachineInfo() {
            const tagSelect = document.getElementById('tag');
            const selectedTag = tagSelect.value;

            if (selectedTag && CONFIG.MACHINE_DATA[selectedTag]) {
                const machineData = CONFIG.MACHINE_DATA[selectedTag];

                document.getElementById('modelo').value = machineData.modelo;
                document.getElementById('sn').value = machineData.sn;
                document.getElementById('entrega').value = machineData.entrega;
                document.getElementById('cliente').value = machineData.cliente;

                // Salvar após atualizar
                dataManager.save();
            }
        }

        function togglePhotoCounter() {
            const counterSection = document.getElementById('photoCounterSection');
            counterSection.classList.toggle('show');

            if (counterSection.classList.contains('show')) {
                // Focar no input quando abrir
                setTimeout(() => {
                    document.getElementById('photoCountInput').focus();
                }, 100);
            }
        }

        function addPhotosFromCounter() {
            const input = document.getElementById('photoCountInput');
            let numPhotos = parseInt(input.value);

            // Validar se é um número válido
            if (isNaN(numPhotos) || numPhotos < 1) {
                alert('Por favor, insira um número válido de fotos.');
                input.focus();
                return;
            }

            // Garantir que seja um número par entre 2 e o máximo
            if (numPhotos < 2) numPhotos = 2;
            if (numPhotos > CONFIG.MAX_PHOTO_COUNT) numPhotos = CONFIG.MAX_PHOTO_COUNT;

            // Ajustar para o número par mais próximo
            if (numPhotos % 2 !== 0) {
                numPhotos = numPhotos + 1;
                alert(`O número de fotos foi ajustado para ${numPhotos} (número par mais próximo).`);
            }

            // Atualizar o valor do input para mostrar o número ajustado
            input.value = numPhotos;

            // Adicionar as fotos
            photoCount = numPhotos;
            PhotoManager.createPhotoGrid(photoCount);

            // Fechar a seção do contador
            togglePhotoCounter();

            // Salvar após adicionar fotos
            dataManager.save();
        }

        function addMultiplePhotos() {
            PhotoManager.addMultiplePhotos();
        }

        function showPhotoOptions(index) {
            currentPhotoIndex = index;
            const menu = document.getElementById('photoOptionsMenu');

            // Verificar se a foto já está anexada
            const photoItems = document.querySelectorAll('.photo-grid-item');
            const hasImage = photoItems[index] &&
                photoItems[index].querySelector('img') &&
                photoItems[index].querySelector('img').src &&
                photoItems[index].querySelector('img').src !== window.location.href &&
                photoItems[index].querySelector('img').style.display !== 'none';

            // Modificar o HTML do menu para incluir a opção de tela cheia se houver imagem
            if (hasImage) {
                menu.innerHTML = `
                    <h4 class="photo-options-title">Opções da Foto</h4>
                    <button class="photo-option-btn" onclick="openCamera()">
                        <i class="fas fa-camera"></i>
                        Abrir Câmera
                    </button>
                    <button class="photo-option-btn" onclick="pasteFromClipboard()">
                        <i class="fas fa-paste"></i>
                        Colar Foto (Ctrl+V)
                    </button>
                    <button class="photo-option-btn" onclick="openFileSelector()">
                        <i class="fas fa-upload"></i>
                        Anexar Arquivo
                    </button>
                    <button class="photo-option-btn" onclick="openFullscreen(${index})">
                        <i class="fas fa-expand"></i>
                        Visualizar em Tela Cheia
                    </button>
                    <button class="photo-option-btn" onclick="openPhotoEditor(${index})">
                        <i class="fas fa-edit"></i>
                        Editar Foto
                    </button>
                    <button class="photo-option-btn photo-option-cancel" onclick="closePhotoOptions()">
                        <i class="fas fa-times"></i>
                        Cancelar
                    </button>
                `;
            } else {
                menu.innerHTML = `
                    <h4 class="photo-options-title">Adicionar Foto</h4>
                    <button class="photo-option-btn" onclick="openCamera()">
                        <i class="fas fa-camera"></i>
                        Abrir Câmera
                    </button>
                    <button class="photo-option-btn" onclick="pasteFromClipboard()">
                        <i class="fas fa-paste"></i>
                        Colar Foto (Ctrl+V)
                    </button>
                    <button class="photo-option-btn" onclick="openFileSelector()">
                        <i class="fas fa-upload"></i>
                        Anexar Arquivo
                    </button>
                    <button class="photo-option-btn photo-option-cancel" onclick="closePhotoOptions()">
                        <i class="fas fa-times"></i>
                        Cancelar
                    </button>
                `;
            }

            // Primeiro garantir que o display esteja correto
            menu.style.display = 'block';

            // Adicionar um pequeno delay antes de adicionar a classe show
            setTimeout(() => {
                menu.classList.add('show');
            }, 10);
        }

        function closePhotoOptions() {
            const menu = document.getElementById('photoOptionsMenu');
            menu.classList.remove('show');

            // Forçar o estilo display none para garantir que o menu feche
            setTimeout(() => {
                menu.style.display = 'none';
            }, 100);

            currentPhotoIndex = null;
        }

        function openCamera() {
            if (currentPhotoIndex !== null) {
                PhotoManager.openCamera(currentPhotoIndex);
                closePhotoOptions();
            }
        }

        function pasteFromClipboard() {
            if (currentPhotoIndex !== null) {
                PhotoManager.pasteFromClipboard(currentPhotoIndex);
                closePhotoOptions();
            }
        }

        function openFileSelector() {
            if (currentPhotoIndex !== null) {
                PhotoManager.openFileSelector(currentPhotoIndex);
                closePhotoOptions();
            }
        }

        function deletePhoto(index) {
            PhotoManager.deletePhoto(index);
        }

        function openPhotoEditor(index) {
            currentEditingPhotoIndex = index;
            const photoItems = document.querySelectorAll('.photo-grid-item');

            if (photoItems[index]) {
                const img = photoItems[index].querySelector('img');

                if (img && img.src && img.src !== window.location.href && img.style.display !== 'none') {
                    // Inicializar editor de foto
                    photoEditor = new PhotoEditor();
                    photoEditor.initialize(img.src);

                    // Mostrar modal
                    document.getElementById('photoEditorModal').classList.add('show');
                } else {
                    alert('Por favor, adicione uma foto antes de editar.');
                }
            }
        }

        function closePhotoEditor() {
            if (photoEditor) {
                photoEditor.dispose();
                photoEditor = null;
            }

            document.getElementById('photoEditorModal').classList.remove('show');
        }

        function setDrawingMode(mode) {
            if (photoEditor) {
                photoEditor.setMode(mode);
            }
        }

        function deleteSelected() {
            if (photoEditor) {
                photoEditor.deleteSelected();
            }
        }

        function clearCanvas() {
            if (photoEditor) {
                photoEditor.clear();
            }
        }

        function savePhotoEdit() {
            if (photoEditor && currentEditingPhotoIndex !== null) {
                // Obter imagem editada
                const editedImageData = photoEditor.getEditedImage();

                // Atualizar a imagem no grid
                const photoItems = document.querySelectorAll('.photo-grid-item');
                if (photoItems[currentEditingPhotoIndex]) {
                    const img = photoItems[currentEditingPhotoIndex].querySelector('img');
                    img.src = editedImageData;
                    img.setAttribute('data-edited-image', editedImageData);
                    img.style.display = 'block';

                    // Salvar dados
                    dataManager.save();
                }

                // Fechar editor
                closePhotoEditor();
            }
        }

        function updatePNTable() {
            PhotoManager.updatePNTable();
        }

        function validateAndGenerate() {
            // Validar se há pelo menos um Numero da Peça
            const photoItems = document.querySelectorAll('.photo-grid-item');
            let hasPN = false;
            photoItems.forEach(item => {
                const pn = item.querySelector('[data-field="pn"]')?.value;
                if (pn && pn.trim() !== '') {
                    hasPN = true;
                }
            });

            if (!hasPN) {
                alert('Por favor, informe pelo menos um Numero da Peça (Part Number) obrigatório');
                return;
            }

            // Se tudo estiver OK, mostrar notificação de sucesso
            const notification = document.createElement('div');
            notification.className = 'alert alert-success position-fixed top-0 start-50 translate-middle-x mt-3';
            notification.style.zIndex = '9999';
            notification.style.minWidth = '300px';
            notification.innerHTML = '<i class="fas fa-check-circle me-2"></i>Relatório finalizado com sucesso!';

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function showClearConfirmation() {
            document.getElementById('confirmationDialog').classList.add('show');
        }

        function closeConfirmationDialog() {
            document.getElementById('confirmationDialog').classList.remove('show');
        }

        function clearReport() {
            // Limpar todos os campos do formulário
            const fields = ['modelo', 'sn', 'tag', 'entrega', 'cliente', 'descricao', 'machineDown',
                            'data', 'inspetor', 'horimetro'];

            fields.forEach(field => {
                const element = document.getElementById(field);
                if (element) {
                    element.value = '';
                }
            });
            
            // Limpar campo de conclusão
            const conclusionField = document.getElementById('conclusion');
            if (conclusionField) {
                conclusionField.value = '';
            }

            // Redefinir o contador de fotos para o valor inicial
            photoCount = CONFIG.INITIAL_PHOTO_COUNT;

            // Limpar completamente o grid de fotos e recriá-lo com o valor inicial
            const photoGrid = document.getElementById('photoGrid');
            photoGrid.innerHTML = ''; // Limpar completamente o grid

            // Recriar o grid com o número inicial de fotos (vazio)
            for (let i = 0; i < photoCount; i++) {
                const photoItem = document.createElement('div');
                photoItem.className = 'photo-grid-item';

                photoItem.innerHTML = `
                    <div class="photo-actions">
                        <button class="photo-action-btn photo-edit-btn" onclick="openPhotoEditor(${i})" title="Editar Foto">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="photo-action-btn photo-delete-btn" onclick="deletePhoto(${i})" title="Excluir Foto">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <div class="photo-info">
                        <div class="photo-info-item">
                            <div class="photo-info-label required">Numero da Peça:</div>
                            <input type="text" class="photo-info-value" data-field="pn" placeholder="Obrigatório" value="">
                        </div>
                        <div class="photo-info-item">
                            <div class="photo-info-label">Peça:</div>
                            <input type="text" class="photo-info-value" data-field="partName" placeholder="Nome da peça" value="">
                        </div>
                        <div class="photo-info-item">
                            <div class="photo-info-label">Qtd:</div>
                            <input type="number" class="photo-info-value" data-field="quantity" placeholder="Quantidade" value="" min="1">
                        </div>
                    </div>
                    <div class="photo-area" onclick="showPhotoOptions(${i})">
                        <i class="fas fa-camera"></i>
                        <p>Adicionar foto</p>
                        <img style="display: none;" src="" data-edited-image="">
                    </div>
                    <div class="photo-description">
                        <div style="position: relative;">
                            <textarea class="form-control" rows="2" placeholder="Adicione uma descrição detalhada da foto..."></textarea>
                        </div>
                    </div>
                `;

                photoGrid.appendChild(photoItem);
            }

            // Limpar tabela Numero da Peça
            document.getElementById('pnTableBody').innerHTML = '';

            // Limpar completamente o localStorage
            dataManager.clear();
            
            // Limpar tradução atual
            currentTranslation = null;

            // Fechar diálogo de confirmação
            closeConfirmationDialog();

            // Mostrar notificação de sucesso
            const notification = document.createElement('div');
            notification.className = 'alert alert-success position-fixed top-0 start-50 translate-middle-x mt-3';
            notification.style.zIndex = '9999';
            notification.style.minWidth = '300px';
            notification.innerHTML = '<i class="fas fa-check-circle me-2"></i>Relatório limpo com sucesso!';

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function generatePowerPoint() {
            PowerPointGenerator.generatePowerPoint();
        }

        function toggleConfig() {
            const configSection = document.getElementById('configSection');
            configSection.classList.toggle('show');

            // Carregar configurações salvas
            if (configSection.classList.contains('show')) {
                const config = this.getConfig();
                document.getElementById('reportTitle').value = config.reportTitle || '';
                document.getElementById('companyName').value = config.companyName || '';
            }
        }

        function saveConfig() {
            const config = {
                reportTitle: document.getElementById('reportTitle').value,
                companyName: document.getElementById('companyName').value
            };

            localStorage.setItem('reportConfig', JSON.stringify(config));
            alert('Configurações salvas com sucesso!');
        }

        function resetConfig() {
            if (confirm('Tem certeza que deseja resetar todas as configurações?')) {
                localStorage.removeItem('reportConfig');

                // Resetar formulário
                document.getElementById('reportTitle').value = '';
                document.getElementById('companyName').value = '';

                alert('Configurações resetadas com sucesso!');
            }
        }

        function getConfig() {
            const saved = localStorage.getItem('reportConfig');
            return saved ? JSON.parse(saved) : {};
        }

        function exportData() {
            try {
                const formData = dataManager.collectFormData();
                const dataStr = JSON.stringify(formData, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);

                const exportFileDefaultName = `inspecao_ZServices_AI_${new Date().toISOString().split('T')[0]}.json`;

                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();

                const notification = document.createElement('div');
                notification.className = 'alert alert-success position-fixed top-0 start-50 translate-middle-x mt-3';
                notification.style.zIndex = '9999';
                notification.style.minWidth = '300px';
                notification.innerHTML = '<i class="fas fa-check-circle me-2"></i>Dados exportados com sucesso!';

                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.remove();
                }, 3000);
            } catch (error) {
                console.error('Erro ao exportar dados:', error);
                alert('Erro ao exportar dados. Tente novamente.');
            }
        }

        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';

            input.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        try {
                            const formData = JSON.parse(event.target.result);
                            dataManager.restoreFormData(formData);
                            
                            // Restaurar informações de tradução se existirem
                            if (formData.translation) {
                                currentTranslation = formData.translation;
                            }

                            const notification = document.createElement('div');
                            notification.className = 'alert alert-success position-fixed top-0 start-50 translate-middle-x mt-3';
                            notification.style.zIndex = '9999';
                            notification.style.minWidth = '300px';
                            notification.innerHTML = '<i class="fas fa-check-circle me-2"></i>Dados importados com sucesso!';

                            document.body.appendChild(notification);

                            setTimeout(() => {
                                notification.remove();
                            }, 3000);
                        } catch (error) {
                            console.error('Erro ao importar dados:', error);
                            alert('Erro ao importar dados. Verifique o formato do arquivo.');
                        }
                    };
                    reader.readAsText(file);
                }
            });

            input.click();
        }

        function startAutoSave() {
            // Salvar dados a cada intervalo configurado
            autoSaveInterval = setInterval(() => {
                dataManager.save();
            }, CONFIG.AUTO_SAVE_INTERVAL);
        }

        function stopAutoSave() {
            if (autoSaveInterval) {
                clearInterval(autoSaveInterval);
                autoSaveInterval = null;
            }
        }

        // ==================== FUNÇÕES DE TELA CHEIA ====================
        function openFullscreen(index) {
            const photoItems = document.querySelectorAll('.photo-grid-item');
            fullscreenImages = [];

            // Coletar todas as fotos com imagem
            photoItems.forEach((item, i) => {
                const img = item.querySelector('img');
                if (img && img.src && img.src !== window.location.href && img.style.display !== 'none') {
                    fullscreenImages.push({
                        src: img.getAttribute('data-edited-image') || img.src,
                        index: i
                    });
                }
            });

            if (fullscreenImages.length === 0) {
                alert('Nenhuma foto encontrada para visualizar.');
                return;
            }

            // Encontrar o índice da foto atual no array de imagens em tela cheia
            fullscreenIndex = fullscreenImages.findIndex(img => img.index === index);
            if (fullscreenIndex === -1) fullscreenIndex = 0;

            // Mostrar modal
            const modal = document.getElementById('fullscreenModal');
            modal.classList.add('show');

            // Carregar imagem
            updateFullscreenImage();

            // Adicionar eventos de teclado
            document.addEventListener('keydown', handleFullscreenKeydown);

            // Prevenir scroll do body
            document.body.style.overflow = 'hidden';
        }

        function closeFullscreen() {
            const modal = document.getElementById('fullscreenModal');
            modal.classList.remove('show');

            // Remover eventos de teclado
            document.removeEventListener('keydown', handleFullscreenKeydown);

            // Restaurar scroll do body
            document.body.style.overflow = '';

            // Resetar zoom
            const img = document.getElementById('fullscreenImage');
            img.classList.remove('zoomed');
        }

        function updateFullscreenImage() {
            const img = document.getElementById('fullscreenImage');
            const info = document.getElementById('fullscreenInfo');

            if (fullscreenImages.length > 0 && fullscreenIndex >= 0 && fullscreenIndex < fullscreenImages.length) {
                img.src = fullscreenImages[fullscreenIndex].src;
                info.textContent = `Foto ${fullscreenIndex + 1} de ${fullscreenImages.length}`;

                // Resetar zoom
                img.classList.remove('zoomed');
            }
        }

        function navigateFullscreen(direction) {
            if (direction === 1) {
                // Próxima
                fullscreenIndex = (fullscreenIndex + 1) % fullscreenImages.length;
            } else {
                // Anterior
                fullscreenIndex = (fullscreenIndex - 1 + fullscreenImages.length) % fullscreenImages.length;
            }

            updateFullscreenImage();
        }

        function toggleZoom() {
            const img = document.getElementById('fullscreenImage');
            const btn = document.querySelector('.fullscreen-btn[title="Zoom"]');

            img.classList.toggle('zoomed');

            if (img.classList.contains('zoomed')) {
                btn.innerHTML = '<i class="fas fa-search-minus"></i>';
            } else {
                btn.innerHTML = '<i class="fas fa-search-plus"></i>';
            }
        }

        function handleFullscreenKeydown(e) {
            if (e.key === 'Escape') {
                closeFullscreen();
            } else if (e.key === 'ArrowLeft') {
                navigateFullscreen(-1);
            } else if (e.key === 'ArrowRight') {
                navigateFullscreen(1);
            } else if (e.key === ' ' || e.key === 'Enter') {
                e.preventDefault();
                toggleZoom();
            }
        }

        // ==================== FUNÇÕES DA FERRAMENTURA DE TRADUÇÃO ====================
        function toggleTranslationTool() {
            const tool = document.getElementById('translationTool');
            tool.classList.toggle('show');

            if (tool.classList.contains('show')) {
                // Carregar cache de tradução
                TranslationManager.loadCache();

                // Atualizar status
                document.getElementById('translationStatus').textContent =
                    'Clique em "Detectar Textos" para identificar todos os textos na página';
            }
        }

        function toggleDetectionMode() {
            const mode = document.getElementById('textDetectionMode');
            mode.classList.toggle('show');
        }

        function startDetection() {
            detectionMode = true;
            toggleDetectionMode();

            // Detectar elementos de texto
            TranslationManager.detectTextElements();

            // Atualizar status
            document.getElementById('translationStatus').textContent =
                `${detectedTextElements.length} elementos de texto detectados`;

            UIController.showNotification(`${detectedTextElements.length} elementos de texto detectados`, 'success');
        }

        function stopDetection() {
            detectionMode = false;

            // Limpar destaques
            document.querySelectorAll('.highlighted-element').forEach(el => {
                el.classList.remove('highlighted-element');
                const badge = el.querySelector('.text-badge');
                if (badge) badge.remove();
            });

            detectedTextElements = [];

            // Atualizar status
            document.getElementById('translationStatus').textContent =
                'Modo de detecção desativado';

            UIController.showNotification('Modo de detecção desativado', 'info');
        }

        function translateAll() {
            const sourceLang = document.getElementById('sourceLanguage').value;
            const targetLang = document.getElementById('targetLanguage').value;

            // Traduzir elementos detectados
            TranslationManager.translateAllElements(sourceLang, targetLang);
            
            // Forçar tradução de campos dinâmicos
            TranslationManager.forceTranslateAllDynamicFields(sourceLang, targetLang);
        }
        
        function swapLanguages() {
            const sourceLang = document.getElementById('sourceLanguage');
            const targetLang = document.getElementById('targetLanguage');

            // Trocar valores
            const temp = sourceLang.value;
            sourceLang.value = targetLang.value;
            targetLang.value = temp;
        }

        // ==================== CONTROLADOR DE UI ====================
        const UIController = {
            showNotification: function(message, type = 'success') {
                const notification = document.createElement('div');
                notification.className = `alert alert-${type} position-fixed top-0 start-50 translate-middle-x mt-3`;
                notification.style.zIndex = '9999';
                notification.style.minWidth = '300px';

                if (type === 'success') {
                    notification.innerHTML = `<i class="fas fa-check-circle me-2"></i>${message}`;
                } else if (type === 'error') {
                    notification.innerHTML = `<i class="fas fa-exclamation-circle me-2"></i>${message}`;
                } else if (type === 'warning') {
                    notification.innerHTML = `<i class="fas fa-exclamation-triangle me-2"></i>${message}`;
                }

                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.remove();
                }, 3000);
            },

            showLoading: function(message = 'Processando...') {
                const spinner = document.getElementById('loadingSpinner');
                const errorText = document.getElementById('errorText');
                const successText = document.getElementById('successText');
                let loadingText = spinner.querySelector('.loading-text');

                spinner.classList.add('active');
                errorText.style.display = 'none';
                successText.style.display = 'none';

                loadingText.textContent = message;
            },

            hideLoading: function() {
                const spinner = document.getElementById('loadingSpinner');
                spinner.classList.remove('active');
            }
        };

        // Adicionar suporte a gestos de toque para navegação em dispositivos móveis
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', function(e) {
            const fullscreenModal = document.getElementById('fullscreenModal');
            if (fullscreenModal && fullscreenModal.classList.contains('show')) {
                touchStartX = e.changedTouches[0].screenX;
            }
        });

        document.addEventListener('touchend', function(e) {
            const fullscreenModal = document.getElementById('fullscreenModal');
            if (fullscreenModal && fullscreenModal.classList.contains('show')) {
                touchEndX = e.changedTouches[0].screenX;
                handleSwipe();
            }
        });

        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;

            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    // Swipe para a esquerda - próxima imagem
                    navigateFullscreen(-1);
                } else {
                    // Swipe para a direita - imagem anterior
                    navigateFullscreen(1);
                }
            }
        }

        // ==================== INICIALIZAÇÃO ====================
       // ==================== INICIALIZAÇÃO ====================
document.addEventListener('DOMContentLoaded', function() {
    // Detectar se é um dispositivo móvel
    const isMobile = window.innerWidth <= 768;
    
    // Em dispositivos móveis, garantir que a sidebar esteja colapsada
    if (isMobile) {
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.querySelector('.main-content');
        const sidebarToggle = document.getElementById('sidebarToggle');
        
        sidebar.classList.add('collapsed');
        mainContent.classList.add('expanded');
        sidebarToggle.classList.remove('shifted');
    }
    
    // Carregar dados salvos
    dataManager.load();
    
    // Inicializar grid de fotos
    PhotoManager.createPhotoGrid(CONFIG.INITIAL_PHOTO_COUNT);
    
    // Iniciar auto-salvamento
    startAutoSave();
    
    // Adicionar eventos aos botões de tradução
    document.getElementById('translateBtn').addEventListener('click', toggleTranslationTool);
    
    // Adicionar eventos aos botões de controle da ferramenta de tradução
    document.getElementById('closeTranslationBtn').addEventListener('click', function() {
        document.getElementById('translationTool').classList.remove('show');
    });
    
    document.getElementById('swapLanguagesBtn').addEventListener('click', swapLanguages);
    document.getElementById('translateAllBtn').addEventListener('click', translateAll);
    
    document.getElementById('detectTextBtn').addEventListener('click', startDetection);
    
    document.getElementById('closeDetectionBtn').addEventListener('click', stopDetection);
    document.getElementById('startDetectionBtn').addEventListener('click', startDetection);
    document.getElementById('stopDetectionBtn').addEventListener('click', stopDetection);
    
    // Adicionar evento de teclado para colar imagem (Ctrl+V)
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'v') {
            e.preventDefault();
            // Verificar se estamos em uma área de foto
            const photoAreas = document.querySelectorAll('.photo-area');
            let inPhotoArea = false;
            
            photoAreas.forEach(area => {
                if (area.matches(':hover')) {
                    inPhotoArea = true;
                }
            });
            
            if (inPhotoArea) {
                // Encontrar o índice da área de foto
                photoAreas.forEach((area, index) => {
                    if (area.matches(':hover')) {
                        PhotoManager.pasteFromClipboard(index);
                    }
                });
            }
        }
    });
    
    // Adicionar evento ao botão de toggle da sidebar
    document.getElementById('sidebarToggle').addEventListener('click', function() {
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.querySelector('.main-content');
        
        sidebar.classList.toggle('collapsed');
        mainContent.classList.toggle('expanded');
        
        // Atualizar posição do botão
        this.classList.toggle('shifted');
    });
    
    // Adicionar evento para redimensionamento da janela
    window.addEventListener('resize', function() {
        const isMobileNow = window.innerWidth <= 768;
        
        if (isMobileNow) {
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.querySelector('.main-content');
            const sidebarToggle = document.getElementById('sidebarToggle');
            
            // Garantir que a sidebar esteja colapsada em mobile
            if (!sidebar.classList.contains('collapsed')) {
                sidebar.classList.add('collapsed');
                mainContent.classList.add('expanded');
                sidebarToggle.classList.remove('shifted');
            }
        }
    });
    
    // Adicionar evento de orientação para dispositivos móveis
    window.addEventListener('orientationchange', function() {
        setTimeout(function() {
            // Forçar reajuste após mudança de orientação
            window.dispatchEvent(new Event('resize'));
        }, 200);
    });
});
        // ==================== FUNÇÕES DE E-MAIL ====================
function toggleEmailMenu() {
    const menu = document.getElementById('emailOptionsMenu');
    menu.style.display = 'block';
    
    setTimeout(() => {
        menu.classList.add('show');
    }, 10);
}

function closeEmailOptions() {
    const menu = document.getElementById('emailOptionsMenu');
    menu.classList.remove('show');
    
    setTimeout(() => {
        menu.style.display = 'none';
    }, 300);
}

function sendEmail(type) {
    // Coletar dados do formulário
    const inspectionData = {
        tag: document.getElementById('tag')?.value || '',
        modelo: document.getElementById('modelo')?.value || '',
        descricao: document.getElementById('descricao')?.value || '',
        data: document.getElementById('date')?.value || ''
    };
    
    // Construir URL do e-mail
    const subject = `Relatório Técnico – ${inspectionData.descricao || 'Serviço'} – Máquina ${inspectionData.tag || 'Identificação'}`;
    
    const body = `Prezados,

Segue o relatório técnico referente ${inspectionData.descricao || 'descrição do serviço'} da máquina ${inspectionData.modelo || 'modelo'}, realizado no dia ${PowerPointGenerator.formatDateForDisplay(inspectionData.data)}.

O serviço foi executado e encontra-se detalhado no relatório em anexo.

Fico à disposição para quaisquer esclarecimentos adicionais.`;
    
    let to, cc;
    
    if (type === 'analise') {
        // Email para análise - apenas para Wallysson e Emerson
        to = 'wallysson-s@zaminebrasil.com,emerson-a@zaminebrasil.com';
        cc = '';
    } else {
        // Email concluído - para todos
        to = 'engenharia1@zaminebrasil.com,victor-a@zaminebrasil.com,fernando-p@zaminebrasil.com,cristiano-c@zaminebrasil.com,alvino-j@zaminebrasil.com';
        cc = 'julio-s@zaminebrasil.com,wallysson-s@zaminebrasil.com,ranielly-s@zaminebrasil.com,marcos-b@zaminebrasil.com,jadson-r@zaminebrasil.com,rafaela-m@zaminebrasil.com,warlen-s@zaminebrasil.com,cicero-c@zaminebrasil.com,higor-a@zaminebrasil.com,max-r@zaminebrasil.com,marcelo-p@zaminebrasil.com,jun-shibuya@zaminebrasil.com,weslley-f@zaminebrasil.com,emerson-a@zaminebrasil.com';
    }
    
    const mailtoUrl = `mailto:${to}?cc=${cc}&subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
    
    window.open(mailtoUrl);
    closeEmailOptions();
}
    </script>
<!-- Email Options Menu -->
<div id="emailOptionsMenu" class="email-options-menu">
    <h4 class="email-options-title">Enviar E-mail</h4>
    <button class="email-option-btn" onclick="sendEmail('analise')">
        <i class="fas fa-search"></i>
        Análise
    </button>
    <button class="email-option-btn" onclick="sendEmail('concluido')">
        <i class="fas fa-check-circle"></i>
        Concluído
    </button>
    <button class="email-option-btn email-option-cancel" onclick="closeEmailOptions()">
        <i class="fas fa-times"></i>
        Cancelar
    </button>
</div>
</body>
